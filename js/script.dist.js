!function e(t,i,n){function o(l,r){if(!i[l]){if(!t[l]){var d="function"==typeof require&&require;if(!r&&d)return d(l,!0);if(s)return s(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var a=i[l]={exports:{}};t[l][0].call(a.exports,function(e){var i=t[l][1][e];return o(i?i:e)},a,a.exports,e,t,i,n)}return i[l].exports}for(var s="function"==typeof require&&require,l=0;l<n.length;l++)o(n[l]);return o}({1:[function(e){!function(){function t(){new i($("#container"))}var i=e("./classes/App");t()}()},{"./classes/App":3}],2:[function(e,t){t.exports=function(){function e(e){console.log("[AddContributor] constructor"),this.$el=e,this.input=this.$el.find(".input-contributor")[0],this.$el.find(".input-contributor")[0].addEventListener("submit",this.submitHandler.bind(this))}return e.prototype.submitHandler=function(e){e.preventDefault(),console.log("SUBMUT"),this.input.value=""},e}()},{}],3:[function(e,t){t.exports=function(){function t(e){console.log("[App] constructor"),this.$el=e,this.position={},this.whiteboard=new i(this.$el),this.elementPicker=new n(this.$el),bean.on(this.whiteboard,"whiteboard-clicked",this.whiteboardClickedHandler.bind(this)),bean.on(this.elementPicker,"element-picker-clicked",this.elementPickerClickedHandler.bind(this))}var i=e("./Whiteboard"),n=e("./ElementPicker"),o=e("./Element");return t.prototype.whiteboardClickedHandler=function(e){console.log("[App] whiteboardClickedHandler"),this.elementPicker.toggleVisible(),this.elementPicker.setLocation(e.xPos,e.yPos),this.position=e},t.prototype.elementPickerClickedHandler=function(e){console.log("[App] elementPickerClickedHandler"),this.elementPicker.toggleVisible();new o(this.$el,e,this.position)},t}()},{"./Element":5,"./ElementPicker":6,"./Whiteboard":7}],4:[function(e,t){t.exports=function(){function e(e,t){console.log("[EditMenu] constructor"),this.$el=e,this.elementId=t;var i=$("#edit-menu-template").text(),n=Handlebars.compile(i),o={actions:[{actionId:"cancel",name:"annuleer"},{actionId:"edit",name:"wijzigen"},{actionId:"remove",name:"verwijderen"}]};Handlebars.registerHelper("editmenu",function(){var e=Handlebars.escapeExpression(this.actionId),t=Handlebars.escapeExpression(this.name);return new Handlebars.SafeString("<li id="+e+">"+t+"</li>")});var s=n(o);this.$el.find("#"+this.elementId).append(s),this.$el.find("#"+this.elementId+" > p").toggleClass("hidden"),this.bindHandlers(),this.toggleVisible()}return e.prototype.toggleVisible=function(){console.log("[EditMenu] toggleVisible"),this.$el.find("#"+this.elementId+" > p").toggleClass("hidden"),this.$el.find("#"+this.elementId+" .edit-menu").toggleClass("hidden")},e.prototype.bindHandlers=function(){console.log("[EditMenu] bindHandlers"),this.$el.find("#"+this.elementId+" > p").on("click",this.clickHandler.bind(this)),this.$el.find("#"+this.elementId+" li").on("click",this.clickHandler.bind(this))},e.prototype.clickHandler=function(e){if(console.log("[EditMenu] clickHandler"),"editButton"===e.target.className)bean.fire(this,"edit-clicked",t),this.toggleVisible();else{var t={};t.targetId=e.target.id,t.elementId=this.elementId,bean.fire(this,"action-clicked",t)}},e}()},{}],5:[function(e,t){t.exports=function(){function t(e,t,i,n){console.log("[Element] constructor"),this.$el=e,this.elementType=t,this.elementId=n,this.elementId=this.elementId?n:t+"_"+this.$el.find(".element-holder").length,this.position=i,this.createElementHolder()}var i=e("./EditMenu"),n=1,o=e("./elements/Postit"),s=e("./elements/Picture"),l=e("./elements/Motion");return t.prototype.createElementHolder=function(){console.log("[Element] createElementHolder"),this.$el.find("#whiteboard").append("<section class='element-holder'></section>"),this.$el.find(".element-holder:last-of-type").attr("id",this.elementId);var e={top:this.position.yPos,left:this.position.xPos,zIndex:0};this.$el.find("#"+this.elementId).css(e),this.createEditMenu(),this.createElement()},t.prototype.createElement=function(){switch(console.log("[Element] createElement"),this.elementType){case"post-it":this.element=new o,this.$el.find("#"+this.elementId).append(this.element.createPostit()),this.$el.find("#"+this.elementId).append(this.element.createPostit),this.bindHandler(this.$el.find("#"+this.elementId));break;case"static":this.element=new s(this.$el.find("#"+this.elementId)),this.$el.find("#"+this.elementId).append(this.element.createPicture),this.bindHandler(this.$el.find("#"+this.elementId)),this.element.initImageInputs();break;case"motion":this.element=new l(this.$el.find("#"+this.elementId)),this.$el.find("#"+this.elementId).append(this.element.createMotion),this.bindHandler(this.$el.find("#"+this.elementId)),this.element.initMotionInputs()}},t.prototype.bindHandler=function(){console.log("[Element] bindHandler"),this.$el.find("#"+this.elementId).on("mousedown",this.mousedownHandler.bind(this)),this.mouseDown=!1},t.prototype.mousedownHandler=function(e){console.log("[Element] mousedownHandler"),"whiteboard"!==e.target.id&&this.$el.find("#element-picker").removeClass("hidden"),this.mouseDown=!0,this._mouseMoveHandler=this.mouseMoveHandler.bind(this),this._mouseUpHandler=this.mouseUpHandler.bind(this),this.offsetX=e.offsetX,this.offsetY=e.offsetY,++n,document.body.querySelector("#"+this.elementId).style.zIndex=n,document.body.addEventListener("mousemove",this._mouseMoveHandler),document.body.addEventListener("mouseup",this._mouseUpHandler)},t.prototype.createEditMenu=function(){console.log("[Element] createEditMenu"),this.editMenu=new i(this.$el,this.elementId),bean.on(this.editMenu,"edit-clicked",this.editClickedHandler.bind(this)),bean.on(this.editMenu,"action-clicked",this.actionClickedHandler.bind(this))},t.prototype.editClickedHandler=function(){console.log("[Element] editClickedHandler"),this.element.edit(this.$el,this.elementId)},t.prototype.actionClickedHandler=function(e){switch(console.log("[Element] actionClickedHandler"),e.targetId){case"remove":this.editMenu.toggleVisible(),this.$el.find("#"+e.elementId).remove();break;case"edit":console.log("EDITE"),this.element.confirm(),this.editMenu.toggleVisible();break;case"cancel":this.element.endEdit(),this.editMenu.toggleVisible()}},t.prototype.mouseMoveHandler=function(e){if(console.log("[Element] mousemoveHandler"),this.mouseDown===!0){var t=parseInt(e.clientX),i=parseInt(e.clientY);document.body.querySelector("#"+this.elementId).style.left=t-this.offsetX+"px",document.body.querySelector("#"+this.elementId).style.top=i-this.offsetY+"px"}},t.prototype.mouseUpHandler=function(){console.log("[Element] mouseupHandler"),this.mouseDown=!1,document.body.removeEventListener("mousemove",this._mouseMoveHandler),document.body.removeEventListener("mouseup",this._mouseUpHandler)},t}()},{"./EditMenu":4,"./elements/Motion":9,"./elements/Picture":10,"./elements/Postit":11}],6:[function(e,t){t.exports=function(){function e(e){console.log("[ElementPicker] constructor"),this.$el=e,console.log(e);var t=$("#element-picker-template").text(),i=Handlebars.compile(t),n={elements:[{element:"post-it",name:"post-it"},{element:"static",name:"image"},{element:"motion",name:"video"}]};Handlebars.registerHelper("picker",function(){var e=Handlebars.escapeExpression(this.element),t=Handlebars.escapeExpression(this.name);return new Handlebars.SafeString("<li id="+e+">"+t+"</li>")});var o=i(n);this.$el.find("#whiteboard").append($(o)),this.toggleVisible(),this.bindHandler()}return e.prototype.toggleVisible=function(){console.log("[ElementPicker] toggleVisible"),this.$el.find("#element-picker").toggleClass("hidden")},e.prototype.setLocation=function(e,t){console.log("[ElementPicker] setLocation");var i={top:t,left:e};this.$el.find("#element-picker").css(i)},e.prototype.bindHandler=function(){console.log("[ElementPicker] bindHandler"),this.$el.find("#element-picker > ul > li").on("click",this.clickHandler.bind(this))},e.prototype.clickHandler=function(e){console.log("[ElementPicker] clickHandler"),bean.fire(this,"element-picker-clicked",e.target.id)},e}()},{}],7:[function(e,t){t.exports=function(){function t(e){console.log("[Whiteboard] constructor"),this.$el=e,this.createWhiteboard()}var i=e("./WhiteboardSettings");return t.prototype.createWhiteboard=function(){console.log("[Whiteboard] createWhiteboard"),this.board=this.$el.append("<div id='whiteboard'></div>"),this.bindHandler()},t.prototype.bindHandler=function(){console.log("[Whiteboard] bindHandler"),this.board.on("click",this.clickHandler.bind(this))},t.prototype.clickHandler=function(e){console.log("[Whiteboard] clickHandler");var t=e.pageX-this.$el.offset().left,i=e.pageY-this.$el.offset().top,n={};n.xPos=t,n.yPos=i,"whiteboard"===e.target.id&&bean.fire(this,"whiteboard-clicked",n)},t.prototype.addWhiteboardSettings=function(){console.log("[Whiteboard] addWhiteboardSettings"),this.whiteboardSettings=new i(this.$el),this.whiteboardSettings.createSettingPanel(),this.whiteboardSettings.addContributor()},t}()},{"./WhiteboardSettings":8}],8:[function(e,t){t.exports=function(){function t(e,t,i){console.log("[WhiteboardSettings] constructor"),this.$el=e,this.contributors=t,i&&(this.prjct_title=i)}var i=e("./AddContributor");return t.prototype.createSettingPanel=function(){console.log("[WhiteboardSettings] createSettingPanel");var e=$("#setting-template").text(),t=Handlebars.compile(e),i={};i.prjct_title=this.prjct_title?this.prjct_title:"Untitled",i.contributor=this.contributor;var n=t(i);$("#whiteboard").append($(n))},t.prototype.addContributor=function(){console.log("[WhiteboardSettings] addContributor"),this.addContributor=new i(this.$el.find(".contributor-form")),console.log(this.$el)},t}()},{"./AddContributor":2}],9:[function(e,t){t.exports=function(){function e(e,t,i,n){console.log("[Motion] constructor"),this.$el=e,console.log(e),n&&(this.vidSrc=n),window.File&&window.FileReader&&window.FileList&&window.Blob}function t(e){console.log("[Motion] initMotionInput"),e.classList.add("motion-input-js");var t=e.querySelector("input[type=file]");t.addEventListener("change",i);var n=document.createElement("div");n.classList.add("motion-input-preview"),e.insertBefore(n,t)}function i(){if(console.log("Input changed"),this.files&&this.files[0]&&this.files[0].type.match("video.*")){var e=new FileReader,t=this.parentNode.querySelector(".motion-input-preview");e.onload=function(e){var i=document.createElement("video");i.onload=function(){console.log(i),i.width>300?(newWidth=i.width/img.width*300,newHeight=i.height/img.width*300):(newWidth=i.width,newHeight=i.height),0===errors.length?t.style.src="'"+e.target.result+"'":(alert(errors.join("\n")),errors=[])},i.setAttribute("src",e.target.result)},e.readAsDataURL(this.files[0])}else errors.push("File is not a valid video")}return e.prototype.createMotion=function(){console.log("[Motion] creatMotion");var e=$("#motion-template").text(),t=Handlebars.compile(e),i={};i.vidSrc=this.txt?this.vidSrc:"";var n=t(i);return $(n)},e.prototype.initMotionInputs=function(){console.log("[Motion] initMotionInputs");var e=this.$el.find(".motion-input")[0];t(e)},e}()},{}],10:[function(e,t){t.exports=function(){function e(e,t,i,n){console.log("[Picture] constructor"),this.$el=e,console.log(e),n&&(this.imgSrc=n),window.File&&window.FileReader&&window.FileList&&window.Blob&&console.log("Full file support")}function t(e){e.classList.add("image-input-js");var t=e.querySelector("input[type=file]");t.addEventListener("change",i);var n=document.createElement("div");n.classList.add("image-input-preview"),e.insertBefore(n,t)}function i(){if(console.log("Input changed"),this.files&&this.files[0]&&this.files[0].type.match("image.*")){var e=new FileReader,t=this.parentNode.querySelector(".image-input-preview");e.onload=function(e){var i=document.createElement("img");i.onload=function(){i.width>300?(newWidth=i.width/i.width*300,newHeight=i.height/i.width*300):(newWidth=i.width,newHeight=i.height),0===n.length?(t.style.backgroundImage="url('"+e.target.result+"')",t.style.height=newHeight+"px",t.style.width=newWidth+"px"):(alert(n.join("\n")),n=[])},i.setAttribute("src",e.target.result),i.setAttribute("width",i.width),i.setAttribute("height",i.height)},e.readAsDataURL(this.files[0])}else n.push("File is not a valid image")}var n=[];return e.prototype.createPicture=function(){console.log("[Picture] creatPicture");var e=$("#picture-template").text(),t=Handlebars.compile(e),i={};i.imgSrc=this.txt?this.imgSrc:"";var n=t(i);return $(n)},e.prototype.initImageInputs=function(){console.log("[Picture] initImageinputs");var e=this.$el.find(".image-input")[0];t(e)},e.prototype.edit=function(){console.log("[Picture] edit")},e.prototype.confirm=function(){console.log("[Picture] confirm")},e.prototype.endEdit=function(){console.log("[Picture] endEdit")},e}()},{}],11:[function(e,t){t.exports=function(){function t(e){console.log("[Postit] constructor"),this.txt=e,this.txt||(this.txt="Nieuwe Postit")}var i=e("./PostitEdit");return t.prototype.createPostit=function(){console.log("[Postit] createPostit");var e=$("#postit-template").text(),t=Handlebars.compile(e),i={};i.txt=this.txt;var n=t(i);return $(n)},t.prototype.edit=function(e,t){console.log("[Postit] edit"),this.$el=e,this.elementId=t,this.$el.find("#"+t+" > .postit > p").toggleClass("hidden"),this.$el.find("#"+t).append(new i(this.txt))},t.prototype.confirm=function(){console.log("[Postit] confirm"),this.txt=this.$el.find("#"+this.elementId+" .postit-edit").val(),this.endEdit()},t.prototype.endEdit=function(){console.log("[Postit] endEdit"),this.$el.find("#"+this.elementId+" > .postit > p").addClass("hidden").text(this.txt),this.$el.find("#"+this.elementId+" > .postit-edit").remove(),this.$el.find("#"+this.elementId+" > .postit > p").toggleClass("hidden")},t}()},{"./PostitEdit":12}],12:[function(e,t){t.exports=function(){function e(e){console.log("[PostitEdit] constructor");var t=$("#postit-edit-template").text(),i=Handlebars.compile(t),n={};n.txt=e;var o=i(n);return $(o)}return e}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zcmMvc2NyaXB0LmpzIiwianMvc3JjL2NsYXNzZXMvQWRkQ29udHJpYnV0b3IuanMiLCJqcy9zcmMvY2xhc3Nlcy9BcHAuanMiLCJqcy9zcmMvY2xhc3Nlcy9FZGl0TWVudS5qcyIsImpzL3NyYy9jbGFzc2VzL0VsZW1lbnQuanMiLCJqcy9zcmMvY2xhc3Nlcy9FbGVtZW50UGlja2VyLmpzIiwianMvc3JjL2NsYXNzZXMvV2hpdGVib2FyZC5qcyIsImpzL3NyYy9jbGFzc2VzL1doaXRlYm9hcmRTZXR0aW5ncy5qcyIsImpzL3NyYy9jbGFzc2VzL2VsZW1lbnRzL01vdGlvbi5qcyIsImpzL3NyYy9jbGFzc2VzL2VsZW1lbnRzL1BpY3R1cmUuanMiLCJqcy9zcmMvY2xhc3Nlcy9lbGVtZW50cy9Qb3N0aXQuanMiLCJqcy9zcmMvY2xhc3Nlcy9lbGVtZW50cy9Qb3N0aXRFZGl0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJDQUFBLFFBQUEsR0FBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLENBQUEsSUFBQSxFQUFBLEdBQUEsQ0FBQSxHQUFBLEdBQUEsa0JBQUEsVUFBQSxPQUFBLEtBQUEsR0FBQSxFQUFBLE1BQUEsR0FBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsR0FBQSxHQUFBLEVBQUEsSUFBQSxHQUFBLEdBQUEsT0FBQSx1QkFBQSxFQUFBLElBQUEsTUFBQSxHQUFBLEtBQUEsbUJBQUEsRUFBQSxHQUFBLEdBQUEsRUFBQSxJQUFBLFdBQUEsR0FBQSxHQUFBLEdBQUEsS0FBQSxFQUFBLFFBQUEsU0FBQSxHQUFBLEdBQUEsR0FBQSxFQUFBLEdBQUEsR0FBQSxFQUFBLE9BQUEsR0FBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLE1BQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxHQUFBLEdBQUEsa0JBQUEsVUFBQSxRQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLE9BQUEsS0FBQSxHQUFBLFNBQUEsSUNBQSxXQUlBLFFBQUEsS0FDQSxHQUFBLEdBQUEsRUFBQSxlQUhBLEdBQUEsR0FBQSxFQUFBLGdCQU1BLCtDQ1JBLEVBQUEsUUFBQSxXQUdBLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxnQ0FDQSxLQUFBLElBQUEsRUFDQSxLQUFBLE1BQUEsS0FBQSxJQUFBLEtBQUEsc0JBQUEsR0FDQSxLQUFBLElBQUEsS0FBQSxzQkFBQSxHQUFBLGlCQUFBLFNBQUEsS0FBQSxjQUFBLEtBQUEsT0FXQSxNQVJBLEdBQUEsVUFBQSxjQUFBLFNBQUEsR0FDQSxFQUFBLGlCQUNBLFFBQUEsSUFBQSxVQUVBLEtBQUEsTUFBQSxNQUFBLElBSUEsMkJDakJBLEVBQUEsUUFBQSxXQU1BLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxxQkFDQSxLQUFBLElBQUEsRUFDQSxLQUFBLFlBQ0EsS0FBQSxXQUFBLEdBQUEsR0FBQSxLQUFBLEtBQ0EsS0FBQSxjQUFBLEdBQUEsR0FBQSxLQUFBLEtBRUEsS0FBQSxHQUFBLEtBQUEsV0FBQSxxQkFBQSxLQUFBLHlCQUFBLEtBQUEsT0FDQSxLQUFBLEdBQUEsS0FBQSxjQUFBLHlCQUFBLEtBQUEsNEJBQUEsS0FBQSxPQVhBLEdBQUEsR0FBQSxFQUFBLGdCQUNBLEVBQUEsRUFBQSxtQkFDQSxFQUFBLEVBQUEsWUF3QkEsT0FaQSxHQUFBLFVBQUEseUJBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSxrQ0FDQSxLQUFBLGNBQUEsZ0JBQ0EsS0FBQSxjQUFBLFlBQUEsRUFBQSxLQUFBLEVBQUEsTUFDQSxLQUFBLFNBQUEsR0FHQSxFQUFBLFVBQUEsNEJBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSxxQ0FDQSxLQUFBLGNBQUEsZUFFQSxJQUFBLEdBQUEsS0FBQSxJQUFBLEVBQUEsS0FBQSxXQUdBLDZFQzVCQSxFQUFBLFFBQUEsV0FFQSxRQUFBLEdBQUEsRUFBQSxHQUFBLFFBQUEsSUFBQSwwQkFDQSxLQUFBLElBQUEsRUFDQSxLQUFBLFVBQUEsQ0FDQSxJQUFBLEdBQUEsRUFBQSx1QkFBQSxPQUNBLEVBQUEsV0FBQSxRQUFBLEdBQ0EsR0FDQSxVQUNBLFNBQUEsU0FBQSxLQUFBLGFBQ0EsU0FBQSxPQUFBLEtBQUEsYUFDQSxTQUFBLFNBQUEsS0FBQSxnQkFHQSxZQUFBLGVBQUEsV0FBQSxXQUNBLEdBQUEsR0FBQSxXQUFBLGlCQUFBLEtBQUEsVUFDQSxFQUFBLFdBQUEsaUJBQUEsS0FBQSxLQUVBLE9BQUEsSUFBQSxZQUFBLFdBQ0EsVUFBQSxFQUFBLElBQUEsRUFBQSxVQUlBLElBQUEsR0FBQSxFQUFBLEVBQ0EsTUFBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLFdBQUEsT0FBQSxHQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxVQUFBLFFBQUEsWUFBQSxVQUNBLEtBQUEsZUFDQSxLQUFBLGdCQTBCQSxNQXZCQSxHQUFBLFVBQUEsY0FBQSxXQUFBLFFBQUEsSUFBQSw0QkFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsVUFBQSxRQUFBLFlBQUEsVUFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsVUFBQSxlQUFBLFlBQUEsV0FHQSxFQUFBLFVBQUEsYUFBQSxXQUFBLFFBQUEsSUFBQSwyQkFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsVUFBQSxRQUFBLEdBQUEsUUFBQSxLQUFBLGFBQUEsS0FBQSxPQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxVQUFBLE9BQUEsR0FBQSxRQUFBLEtBQUEsYUFBQSxLQUFBLFFBR0EsRUFBQSxVQUFBLGFBQUEsU0FBQSxHQUNBLEdBREEsUUFBQSxJQUFBLDJCQUNBLGVBQUEsRUFBQSxPQUFBLFVBQ0EsS0FBQSxLQUFBLEtBQUEsZUFBQSxHQUNBLEtBQUEsb0JBQ0EsQ0FDQSxHQUFBLEtBQ0EsR0FBQSxTQUFBLEVBQUEsT0FBQSxHQUNBLEVBQUEsVUFBQSxLQUFBLFVBQ0EsS0FBQSxLQUFBLEtBQUEsaUJBQUEsS0FLQSwyQkNyREEsRUFBQSxRQUFBLFdBU0EsUUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsUUFBQSxJQUFBLHlCQUNBLEtBQUEsSUFBQSxFQUNBLEtBQUEsWUFBQSxFQUNBLEtBQUEsVUFBQSxFQUVBLEtBQUEsVUFEQSxLQUFBLFVBQ0EsRUFFQSxFQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsbUJBQUEsT0FHQSxLQUFBLFNBQUEsRUFDQSxLQUFBLHNCQWxCQSxHQUFBLEdBQUEsRUFBQSxjQUNBLEVBQUEsRUFDQSxFQUFBLEVBQUEscUJBQ0EsRUFBQSxFQUFBLHNCQUNBLEVBQUEsRUFBQSxvQkE0SEEsT0EzR0EsR0FBQSxVQUFBLG9CQUFBLFdBQUEsUUFBQSxJQUFBLGlDQUNBLEtBQUEsSUFBQSxLQUFBLGVBQUEsT0FBQSw4Q0FDQSxLQUFBLElBQUEsS0FBQSxnQ0FBQSxLQUFBLEtBQUEsS0FBQSxVQUNBLElBQUEsSUFDQSxJQUFBLEtBQUEsU0FBQSxLQUNBLEtBQUEsS0FBQSxTQUFBLEtBQ0EsT0FBQSxFQUVBLE1BQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxXQUFBLElBQUEsR0FDQSxLQUFBLGlCQUNBLEtBQUEsaUJBR0EsRUFBQSxVQUFBLGNBQUEsV0FDQSxPQURBLFFBQUEsSUFBQSwyQkFDQSxLQUFBLGFBQ0EsSUFBQSxVQUNBLEtBQUEsUUFBQSxHQUFBLEdBQ0EsS0FBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLFdBQUEsT0FBQSxLQUFBLFFBQUEsZ0JBQ0EsS0FBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLFdBQUEsT0FBQSxLQUFBLFFBQUEsY0FDQSxLQUFBLFlBQUEsS0FBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLFdBQ0EsTUFDQSxLQUFBLFNBQ0EsS0FBQSxRQUFBLEdBQUEsR0FBQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsWUFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsV0FBQSxPQUFBLEtBQUEsUUFBQSxlQUNBLEtBQUEsWUFBQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsWUFDQSxLQUFBLFFBQUEsaUJBQ0EsTUFDQSxLQUFBLFNBQ0EsS0FBQSxRQUFBLEdBQUEsR0FBQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsWUFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsV0FBQSxPQUFBLEtBQUEsUUFBQSxjQUNBLEtBQUEsWUFBQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsWUFDQSxLQUFBLFFBQUEscUJBTUEsRUFBQSxVQUFBLFlBQUEsV0FBQSxRQUFBLElBQUEseUJBQ0EsS0FBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLFdBQUEsR0FBQSxZQUFBLEtBQUEsaUJBQUEsS0FBQSxPQUNBLEtBQUEsV0FBQSxHQUdBLEVBQUEsVUFBQSxpQkFBQSxTQUFBLEdBQUEsUUFBQSxJQUFBLDhCQUNBLGVBQUEsRUFBQSxPQUFBLElBQ0EsS0FBQSxJQUFBLEtBQUEsbUJBQUEsWUFBQSxVQUdBLEtBQUEsV0FBQSxFQUVBLEtBQUEsa0JBQUEsS0FBQSxpQkFBQSxLQUFBLE1BQ0EsS0FBQSxnQkFBQSxLQUFBLGVBQUEsS0FBQSxNQUVBLEtBQUEsUUFBQSxFQUFBLFFBQ0EsS0FBQSxRQUFBLEVBQUEsVUFFQSxFQUNBLFNBQUEsS0FBQSxjQUFBLElBQUEsS0FBQSxXQUFBLE1BQUEsT0FBQSxFQUVBLFNBQUEsS0FBQSxpQkFBQSxZQUFBLEtBQUEsbUJBQ0EsU0FBQSxLQUFBLGlCQUFBLFVBQUEsS0FBQSxrQkFHQSxFQUFBLFVBQUEsZUFBQSxXQUFBLFFBQUEsSUFBQSw0QkFDQSxLQUFBLFNBQUEsR0FBQSxHQUFBLEtBQUEsSUFBQSxLQUFBLFdBQ0EsS0FBQSxHQUFBLEtBQUEsU0FBQSxlQUFBLEtBQUEsbUJBQUEsS0FBQSxPQUNBLEtBQUEsR0FBQSxLQUFBLFNBQUEsaUJBQUEsS0FBQSxxQkFBQSxLQUFBLFFBR0EsRUFBQSxVQUFBLG1CQUFBLFdBQUEsUUFBQSxJQUFBLGdDQUNBLEtBQUEsUUFBQSxLQUFBLEtBQUEsSUFBQSxLQUFBLFlBR0EsRUFBQSxVQUFBLHFCQUFBLFNBQUEsR0FDQSxPQURBLFFBQUEsSUFBQSxrQ0FDQSxFQUFBLFVBQ0EsSUFBQSxTQUNBLEtBQUEsU0FBQSxnQkFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEVBQUEsV0FBQSxRQUNBLE1BQ0EsS0FBQSxPQUFBLFFBQUEsSUFBQSxTQUNBLEtBQUEsUUFBQSxVQUNBLEtBQUEsU0FBQSxlQUNBLE1BQ0EsS0FBQSxTQUNBLEtBQUEsUUFBQSxVQUNBLEtBQUEsU0FBQSxrQkFJQSxFQUFBLFVBQUEsaUJBQUEsU0FBQSxHQUNBLEdBREEsUUFBQSxJQUFBLDhCQUNBLEtBQUEsYUFBQSxFQUFBLENBRUEsR0FBQSxHQUFBLFNBQUEsRUFBQSxTQUNBLEVBQUEsU0FBQSxFQUFBLFFBRUEsVUFBQSxLQUFBLGNBQUEsSUFBQSxLQUFBLFdBQUEsTUFBQSxLQUFBLEVBQUEsS0FBQSxRQUFBLEtBQ0EsU0FBQSxLQUFBLGNBQUEsSUFBQSxLQUFBLFdBQUEsTUFBQSxJQUFBLEVBQUEsS0FBQSxRQUFBLE9BSUEsRUFBQSxVQUFBLGVBQUEsV0FBQSxRQUFBLElBQUEsNEJBRUEsS0FBQSxXQUFBLEVBRUEsU0FBQSxLQUFBLG9CQUFBLFlBQUEsS0FBQSxtQkFDQSxTQUFBLEtBQUEsb0JBQUEsVUFBQSxLQUFBLGtCQUdBLDhHQ2xJQSxFQUFBLFFBQUEsV0FHQSxRQUFBLEdBQUEsR0FBQSxRQUFBLElBQUEsK0JBQ0EsS0FBQSxJQUFBLEVBQ0EsUUFBQSxJQUFBLEVBQ0EsSUFBQSxHQUFBLEVBQUEsNEJBQUEsT0FDQSxFQUFBLFdBQUEsUUFBQSxHQUNBLEdBQ0EsV0FDQSxRQUFBLFVBQUEsS0FBQSxZQUNBLFFBQUEsU0FBQSxLQUFBLFVBQ0EsUUFBQSxTQUFBLEtBQUEsVUFHQSxZQUFBLGVBQUEsU0FBQSxXQUNBLEdBQUEsR0FBQSxXQUFBLGlCQUFBLEtBQUEsU0FDQSxFQUFBLFdBQUEsaUJBQUEsS0FBQSxLQUVBLE9BQUEsSUFBQSxZQUFBLFdBQ0EsVUFBQSxFQUFBLElBQUEsRUFBQSxVQUlBLElBQUEsR0FBQSxFQUFBLEVBQ0EsTUFBQSxJQUFBLEtBQUEsZUFBQSxPQUFBLEVBQUEsSUFDQSxLQUFBLGdCQUNBLEtBQUEsY0F1QkEsTUFwQkEsR0FBQSxVQUFBLGNBQUEsV0FBQSxRQUFBLElBQUEsaUNBQ0EsS0FBQSxJQUFBLEtBQUEsbUJBQUEsWUFBQSxXQUdBLEVBQUEsVUFBQSxZQUFBLFNBQUEsRUFBQSxHQUFBLFFBQUEsSUFBQSw4QkFDQSxJQUFBLElBQ0EsSUFBQSxFQUNBLEtBQUEsRUFFQSxNQUFBLElBQUEsS0FBQSxtQkFBQSxJQUFBLElBR0EsRUFBQSxVQUFBLFlBQUEsV0FBQSxRQUFBLElBQUEsK0JBQ0EsS0FBQSxJQUFBLEtBQUEsNkJBQUEsR0FBQSxRQUFBLEtBQUEsYUFBQSxLQUFBLFFBR0EsRUFBQSxVQUFBLGFBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSxnQ0FDQSxLQUFBLEtBQUEsS0FBQSx5QkFBQSxFQUFBLE9BQUEsS0FHQSwyQkNsREEsRUFBQSxRQUFBLFdBSUEsUUFBQSxHQUFBLEdBQUEsUUFBQSxJQUFBLDRCQUNBLEtBQUEsSUFBQSxFQVFBLEtBQUEsbUJBWEEsR0FBQSxHQUFBLEVBQUEsdUJBMENBLE9BMUJBLEdBQUEsVUFBQSxpQkFBQSxXQUFBLFFBQUEsSUFBQSxpQ0FDQSxLQUFBLE1BQUEsS0FBQSxJQUFBLE9BQUEsK0JBQ0EsS0FBQSxlQUdBLEVBQUEsVUFBQSxZQUFBLFdBQUEsUUFBQSxJQUFBLDRCQUNBLEtBQUEsTUFBQSxHQUFBLFFBQUEsS0FBQSxhQUFBLEtBQUEsUUFHQSxFQUFBLFVBQUEsYUFBQSxTQUFBLEdBQUEsUUFBQSxJQUFBLDRCQUNBLElBQUEsR0FBQSxFQUFBLE1BQUEsS0FBQSxJQUFBLFNBQUEsS0FDQSxFQUFBLEVBQUEsTUFBQSxLQUFBLElBQUEsU0FBQSxJQUNBLElBQ0EsR0FBQSxLQUFBLEVBQ0EsRUFBQSxLQUFBLEVBQ0EsZUFBQSxFQUFBLE9BQUEsSUFDQSxLQUFBLEtBQUEsS0FBQSxxQkFBQSxJQUlBLEVBQUEsVUFBQSxzQkFBQSxXQUFBLFFBQUEsSUFBQSxzQ0FDQSxLQUFBLG1CQUFBLEdBQUEsR0FBQSxLQUFBLEtBQ0EsS0FBQSxtQkFBQSxxQkFDQSxLQUFBLG1CQUFBLGtCQUdBLG1EQzVDQSxFQUFBLFFBQUEsV0FJQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEdBQUEsUUFBQSxJQUFBLG9DQUNBLEtBQUEsSUFBQSxFQUNBLEtBQUEsYUFBQSxFQUNBLElBQ0EsS0FBQSxZQUFBLEdBTkEsR0FBQSxHQUFBLEVBQUEsbUJBa0NBLE9BdkJBLEdBQUEsVUFBQSxtQkFBQSxXQUFBLFFBQUEsSUFBQSwwQ0FDQSxJQUFBLEdBQUEsRUFBQSxxQkFBQSxPQUNBLEVBQUEsV0FBQSxRQUFBLEdBQ0EsSUFHQSxHQUFBLFlBREEsS0FBQSxZQUNBLEtBQUEsWUFFQSxXQUdBLEVBQUEsWUFBQSxLQUFBLFdBRUEsSUFBQSxHQUFBLEVBQUEsRUFDQSxHQUFBLGVBQUEsT0FBQSxFQUFBLEtBR0EsRUFBQSxVQUFBLGVBQUEsV0FBQSxRQUFBLElBQUEsdUNBQ0EsS0FBQSxlQUFBLEdBQUEsR0FBQSxLQUFBLElBQUEsS0FBQSxzQkFDQSxRQUFBLElBQUEsS0FBQSxNQUlBLCtDQ3BDQSxFQUFBLFFBQUEsV0FFQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLElBQUEsd0JBQ0EsS0FBQSxJQUFBLEVBQ0EsUUFBQSxJQUFBLEdBQ0EsSUFDQSxLQUFBLE9BQUEsR0FJQSxPQUFBLE1BQ0EsT0FBQSxZQUNBLE9BQUEsVUFDQSxPQUFBLEtBMkJBLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSw0QkFDQSxFQUFBLFVBQUEsSUFBQSxrQkFFQSxJQUFBLEdBQUEsRUFBQSxjQUFBLG1CQUNBLEdBQUEsaUJBQUEsU0FBQSxFQUVBLElBQUEsR0FBQSxTQUFBLGNBQUEsTUFDQSxHQUFBLFVBQUEsSUFBQSx3QkFHQSxFQUFBLGFBQUEsRUFBQSxHQUdBLFFBQUEsS0FHQSxHQUZBLFFBQUEsSUFBQSxpQkFHQSxLQUFBLE9BQ0EsS0FBQSxNQUFBLElBQ0EsS0FBQSxNQUFBLEdBQUEsS0FBQSxNQUFBLFdBQ0EsQ0FDQSxHQUFBLEdBQUEsR0FBQSxZQUNBLEVBQUEsS0FBQSxXQUFBLGNBQUEsd0JBRUEsR0FBQSxPQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsU0FBQSxjQUFBLFFBRUEsR0FBQSxPQUFBLFdBQ0EsUUFBQSxJQUFBLEdBRUEsRUFBQSxNQUFBLEtBQ0EsU0FBQSxFQUFBLE1BQUEsSUFBQSxNQUFBLElBQ0EsVUFBQSxFQUFBLE9BQUEsSUFBQSxNQUFBLE1BRUEsU0FBQSxFQUFBLE1BQ0EsVUFBQSxFQUFBLFFBR0EsSUFBQSxPQUFBLE9BQ0EsRUFBQSxNQUFBLElBQUEsSUFBQSxFQUFBLE9BQUEsT0FBQSxLQU9BLE1BQUEsT0FBQSxLQUFBLE9BQ0EsWUFHQSxFQUFBLGFBQUEsTUFBQSxFQUFBLE9BQUEsU0FPQSxFQUFBLGNBQUEsS0FBQSxNQUFBLFFBRUEsUUFBQSxLQUFBLDZCQWNBLE1BOUZBLEdBQUEsVUFBQSxhQUFBLFdBQUEsUUFBQSxJQUFBLHVCQUNBLElBQUEsR0FBQSxFQUFBLG9CQUFBLE9BQ0EsRUFBQSxXQUFBLFFBQUEsR0FDQSxJQUdBLEdBQUEsT0FEQSxLQUFBLElBQ0EsS0FBQSxPQUVBLEVBRUEsSUFBQSxHQUFBLEVBQUEsRUFDQSxPQUFBLEdBQUEsSUFLQSxFQUFBLFVBQUEsaUJBQUEsV0FBQSxRQUFBLElBQUEsNEJBQ0EsSUFBQSxHQUFBLEtBQUEsSUFBQSxLQUFBLGlCQUFBLEVBQ0EsR0FBQSxJQTRFQSw0QkNqSEEsRUFBQSxRQUFBLFdBR0EsUUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsUUFBQSxJQUFBLHlCQUNBLEtBQUEsSUFBQSxFQUNBLFFBQUEsSUFBQSxHQUNBLElBQ0EsS0FBQSxPQUFBLEdBSUEsT0FBQSxNQUNBLE9BQUEsWUFDQSxPQUFBLFVBQ0EsT0FBQSxNQUVBLFFBQUEsSUFBQSxxQkEwQkEsUUFBQSxHQUFBLEdBQ0EsRUFBQSxVQUFBLElBQUEsaUJBRUEsSUFBQSxHQUFBLEVBQUEsY0FBQSxtQkFDQSxHQUFBLGlCQUFBLFNBQUEsRUFFQSxJQUFBLEdBQUEsU0FBQSxjQUFBLE1BQ0EsR0FBQSxVQUFBLElBQUEsdUJBR0EsRUFBQSxhQUFBLEVBQUEsR0FHQSxRQUFBLEtBR0EsR0FGQSxRQUFBLElBQUEsaUJBR0EsS0FBQSxPQUNBLEtBQUEsTUFBQSxJQUNBLEtBQUEsTUFBQSxHQUFBLEtBQUEsTUFBQSxXQUNBLENBQ0EsR0FBQSxHQUFBLEdBQUEsWUFDQSxFQUFBLEtBQUEsV0FBQSxjQUFBLHVCQUVBLEdBQUEsT0FBQSxTQUFBLEdBQ0EsR0FBQSxHQUFBLFNBQUEsY0FBQSxNQUVBLEdBQUEsT0FBQSxXQUVBLEVBQUEsTUFBQSxLQUNBLFNBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxJQUNBLFVBQUEsRUFBQSxPQUFBLEVBQUEsTUFBQSxNQUVBLFNBQUEsRUFBQSxNQUNBLFVBQUEsRUFBQSxRQUdBLElBQUEsRUFBQSxRQUNBLEVBQUEsTUFBQSxnQkFBQSxRQUFBLEVBQUEsT0FBQSxPQUFBLEtBQ0EsRUFBQSxNQUFBLE9BQUEsVUFBQSxLQUNBLEVBQUEsTUFBQSxNQUFBLFNBQUEsT0FLQSxNQUFBLEVBQUEsS0FBQSxPQUNBLE9BSUEsRUFBQSxhQUFBLE1BQUEsRUFBQSxPQUFBLFFBQ0EsRUFBQSxhQUFBLFFBQUEsRUFBQSxPQUNBLEVBQUEsYUFBQSxTQUFBLEVBQUEsU0FHQSxFQUFBLGNBQUEsS0FBQSxNQUFBLFFBR0EsR0FBQSxLQUFBLDZCQW5HQSxHQUFBLEtBd0hBLE9BcEdBLEdBQUEsVUFBQSxjQUFBLFdBQUEsUUFBQSxJQUFBLHlCQUNBLElBQUEsR0FBQSxFQUFBLHFCQUFBLE9BQ0EsRUFBQSxXQUFBLFFBQUEsR0FDQSxJQUdBLEdBQUEsT0FEQSxLQUFBLElBQ0EsS0FBQSxPQUVBLEVBRUEsSUFBQSxHQUFBLEVBQUEsRUFDQSxPQUFBLEdBQUEsSUFLQSxFQUFBLFVBQUEsZ0JBQUEsV0FBQSxRQUFBLElBQUEsNEJBQ0EsSUFBQSxHQUFBLEtBQUEsSUFBQSxLQUFBLGdCQUFBLEVBQ0EsR0FBQSxJQXlFQSxFQUFBLFVBQUEsS0FBQSxXQUFBLFFBQUEsSUFBQSxtQkFHQSxFQUFBLFVBQUEsUUFBQSxXQUFBLFFBQUEsSUFBQSxzQkFHQSxFQUFBLFVBQUEsUUFBQSxXQUFBLFFBQUEsSUFBQSxzQkFHQSw0QkN6SEEsRUFBQSxRQUFBLFdBSUEsUUFBQSxHQUFBLEdBQUEsUUFBQSxJQUFBLHdCQUNBLEtBQUEsSUFBQSxFQUNBLEtBQUEsTUFDQSxLQUFBLElBQUEsaUJBTEEsR0FBQSxHQUFBLEVBQUEsZUFvQ0EsT0EzQkEsR0FBQSxVQUFBLGFBQUEsV0FBQSxRQUFBLElBQUEsd0JBQ0EsSUFBQSxHQUFBLEVBQUEsb0JBQUEsT0FDQSxFQUFBLFdBQUEsUUFBQSxHQUNBLElBQ0EsR0FBQSxJQUFBLEtBQUEsR0FDQSxJQUFBLEdBQUEsRUFBQSxFQUNBLE9BQUEsR0FBQSxJQUdBLEVBQUEsVUFBQSxLQUFBLFNBQUEsRUFBQSxHQUFBLFFBQUEsSUFBQSxpQkFDQSxLQUFBLElBQUEsRUFDQSxLQUFBLFVBQUEsRUFDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEVBQUEsa0JBQUEsWUFBQSxVQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsR0FBQSxPQUFBLEdBQUEsR0FBQSxLQUFBLE9BR0EsRUFBQSxVQUFBLFFBQUEsV0FBQSxRQUFBLElBQUEsb0JBQ0EsS0FBQSxJQUFBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxVQUFBLGlCQUFBLE1BQ0EsS0FBQSxXQUdBLEVBQUEsVUFBQSxRQUFBLFdBQUEsUUFBQSxJQUFBLG9CQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxVQUFBLGtCQUFBLFNBQUEsVUFBQSxLQUFBLEtBQUEsS0FDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsVUFBQSxtQkFBQSxTQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxVQUFBLGtCQUFBLFlBQUEsV0FHQSw2Q0N0Q0EsRUFBQSxRQUFBLFdBRUEsUUFBQSxHQUFBLEdBQUEsUUFBQSxJQUFBLDJCQUNBLElBQUEsR0FBQSxFQUFBLHlCQUFBLE9BQ0EsRUFBQSxXQUFBLFFBQUEsR0FDQSxJQUNBLEdBQUEsSUFBQSxDQUVBLElBQUEsR0FBQSxFQUFBLEVBRUEsT0FBQSxHQUFBLEdBSUEsTUFBQSIsImZpbGUiOiJzY3JpcHQuZGlzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiKGZ1bmN0aW9uKCl7XG5cblx0dmFyIEFwcCA9IHJlcXVpcmUoJy4vY2xhc3Nlcy9BcHAnKTtcblxuXHRmdW5jdGlvbiBpbml0KCnCoHtcblx0XHRuZXcgQXBwKCQoJyNjb250YWluZXInKSk7XG5cdH1cblxuXHRpbml0KCk7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXG5cdGZ1bmN0aW9uIEFkZENvbnRyaWJ1dG9yKCRlbCkgeyBjb25zb2xlLmxvZygnW0FkZENvbnRyaWJ1dG9yXSBjb25zdHJ1Y3RvcicpO1xuXHRcdHRoaXMuJGVsID0gJGVsO1xuXHRcdHRoaXMuaW5wdXQgPSB0aGlzLiRlbC5maW5kKCcuaW5wdXQtY29udHJpYnV0b3InKVswXTtcblx0XHR0aGlzLiRlbC5maW5kKCcuaW5wdXQtY29udHJpYnV0b3InKVswXS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdH1cblxuXHRBZGRDb250cmlidXRvci5wcm90b3R5cGUuc3VibWl0SGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KSB7XG5cdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRjb25zb2xlLmxvZyhcIlNVQk1VVFwiKTtcblx0XHQvL2JlYW4uZmlyZSh0aGlzLCBcImFkZENvbnRyaWJ1dG9yXCIsIHRoaXMuaW5wdXQudmFsdWUpO1xuXHRcdHRoaXMuaW5wdXQudmFsdWUgPSAnJztcblx0fTtcblxuXG5cdHJldHVybiBBZGRDb250cmlidXRvcjtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cdHZhciBXaGl0ZWJvYXJkID0gcmVxdWlyZSgnLi9XaGl0ZWJvYXJkJyk7XG5cdHZhciBFbGVtZW50UGlja2VyID0gcmVxdWlyZSgnLi9FbGVtZW50UGlja2VyJyk7XG5cdHZhciBFbGVtZW50ID0gcmVxdWlyZSgnLi9FbGVtZW50Jyk7XG5cblx0ZnVuY3Rpb24gQXBwKCRlbCkgeyBjb25zb2xlLmxvZygnW0FwcF0gY29uc3RydWN0b3InKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHR0aGlzLnBvc2l0aW9uID0ge307XG5cdFx0dGhpcy53aGl0ZWJvYXJkID0gbmV3IFdoaXRlYm9hcmQodGhpcy4kZWwpO1xuXHRcdHRoaXMuZWxlbWVudFBpY2tlciA9IG5ldyBFbGVtZW50UGlja2VyKHRoaXMuJGVsKTtcblx0XHQvL0xVSVNURVJFTlxuXHRcdGJlYW4ub24odGhpcy53aGl0ZWJvYXJkLCBcIndoaXRlYm9hcmQtY2xpY2tlZFwiLCB0aGlzLndoaXRlYm9hcmRDbGlja2VkSGFuZGxlci5iaW5kKHRoaXMpKTtcblx0XHRiZWFuLm9uKHRoaXMuZWxlbWVudFBpY2tlciwgXCJlbGVtZW50LXBpY2tlci1jbGlja2VkXCIsIHRoaXMuZWxlbWVudFBpY2tlckNsaWNrZWRIYW5kbGVyLmJpbmQodGhpcykpO1xuXHR9XG5cblx0QXBwLnByb3RvdHlwZS53aGl0ZWJvYXJkQ2xpY2tlZEhhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbQXBwXSB3aGl0ZWJvYXJkQ2xpY2tlZEhhbmRsZXInKTtcblx0XHR0aGlzLmVsZW1lbnRQaWNrZXIudG9nZ2xlVmlzaWJsZSgpO1xuXHRcdHRoaXMuZWxlbWVudFBpY2tlci5zZXRMb2NhdGlvbihldmVudC54UG9zLCBldmVudC55UG9zKTtcblx0XHR0aGlzLnBvc2l0aW9uID0gZXZlbnQ7XG5cdH07XG5cblx0QXBwLnByb3RvdHlwZS5lbGVtZW50UGlja2VyQ2xpY2tlZEhhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbQXBwXSBlbGVtZW50UGlja2VyQ2xpY2tlZEhhbmRsZXInKTsgXG5cdFx0dGhpcy5lbGVtZW50UGlja2VyLnRvZ2dsZVZpc2libGUoKTtcblx0XHQvL0NSRUFURSBCTEFOQ1xuXHRcdHZhciBlbGVtZW50ID0gbmV3IEVsZW1lbnQodGhpcy4kZWwsZXZlbnQsdGhpcy5wb3NpdGlvbik7XG5cdH07XG5cblx0cmV0dXJuIEFwcDtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cdGZ1bmN0aW9uIEVkaXRNZW51KCRlbCxlbGVtZW50SWQpIHsgY29uc29sZS5sb2coJ1tFZGl0TWVudV0gY29uc3RydWN0b3InKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHR0aGlzLmVsZW1lbnRJZCA9IGVsZW1lbnRJZDtcblx0XHR2YXIgZW50cnlUZXh0ID0gJCgnI2VkaXQtbWVudS10ZW1wbGF0ZScpLnRleHQoKTtcblx0XHR2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoZW50cnlUZXh0KTtcblx0XHR2YXIgY29udGV4dCA9IHtcblx0XHQgIGFjdGlvbnM6IFtcdFxuXHRcdCAgXHRcdFx0e2FjdGlvbklkOiBcImNhbmNlbFwiLCBuYW1lOiBcImFubnVsZWVyXCJ9LFxuXHRcdCAgXHRcdFx0e2FjdGlvbklkOiBcImVkaXRcIiwgbmFtZTogXCJ3aWp6aWdlblwifSxcblx0XHQgIFx0XHRcdHthY3Rpb25JZDogXCJyZW1vdmVcIiwgbmFtZTogXCJ2ZXJ3aWpkZXJlblwifVxuICBcdFx0XHRcdF1cbiAgXHRcdFx0fTtcblx0XHRcdEhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ2VkaXRtZW51JywgZnVuY3Rpb24oKSB7XG5cdFx0XHQgIHZhciBhY3Rpb25JZCA9IEhhbmRsZWJhcnMuZXNjYXBlRXhwcmVzc2lvbih0aGlzLmFjdGlvbklkKSxcblx0XHRcdCAgICAgIG5hbWUgPSBIYW5kbGViYXJzLmVzY2FwZUV4cHJlc3Npb24odGhpcy5uYW1lKTtcblxuXHRcdFx0ICByZXR1cm4gbmV3IEhhbmRsZWJhcnMuU2FmZVN0cmluZyhcblx0XHRcdCAgICBcIjxsaSBpZD1cIithY3Rpb25JZCtcIj5cIituYW1lK1wiPC9saT5cIlxuXHRcdFx0ICApO1xuXHRcdFx0fSk7XG5cdFx0XG5cdFx0dmFyIGh0bWwgPSB0ZW1wbGF0ZShjb250ZXh0KTtcblx0XHR0aGlzLiRlbC5maW5kKCcjJyt0aGlzLmVsZW1lbnRJZCkuYXBwZW5kKGh0bWwpO1xuXHRcdHRoaXMuJGVsLmZpbmQoJyMnK3RoaXMuZWxlbWVudElkKycgPiBwJykudG9nZ2xlQ2xhc3MoJ2hpZGRlbicpO1xuXHRcdHRoaXMuYmluZEhhbmRsZXJzKCk7XG5cdFx0dGhpcy50b2dnbGVWaXNpYmxlKCk7XG5cdH1cblxuXHRFZGl0TWVudS5wcm90b3R5cGUudG9nZ2xlVmlzaWJsZSA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbRWRpdE1lbnVdIHRvZ2dsZVZpc2libGUnKTtcblx0XHR0aGlzLiRlbC5maW5kKCcjJyt0aGlzLmVsZW1lbnRJZCsnID4gcCcpLnRvZ2dsZUNsYXNzKCdoaWRkZW4nKTtcblx0XHR0aGlzLiRlbC5maW5kKCcjJyt0aGlzLmVsZW1lbnRJZCsnIC5lZGl0LW1lbnUnKS50b2dnbGVDbGFzcygnaGlkZGVuJyk7XG5cdH07XG5cblx0RWRpdE1lbnUucHJvdG90eXBlLmJpbmRIYW5kbGVycyA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbRWRpdE1lbnVdIGJpbmRIYW5kbGVycycpO1xuXHRcdHRoaXMuJGVsLmZpbmQoJyMnK3RoaXMuZWxlbWVudElkKycgPiBwJykub24oJ2NsaWNrJywgdGhpcy5jbGlja0hhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0dGhpcy4kZWwuZmluZCgnIycrdGhpcy5lbGVtZW50SWQrJyBsaScpLm9uKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyLmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdEVkaXRNZW51LnByb3RvdHlwZS5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbRWRpdE1lbnVdIGNsaWNrSGFuZGxlcicpO1xuXHRcdGlmKGV2ZW50LnRhcmdldC5jbGFzc05hbWUgPT09IFwiZWRpdEJ1dHRvblwiKXtcblx0XHRcdGJlYW4uZmlyZSh0aGlzLCBcImVkaXQtY2xpY2tlZFwiLCBhY3Rpb25FdmVudCk7XG5cdFx0XHR0aGlzLnRvZ2dsZVZpc2libGUoKTtcblx0XHR9ZWxzZXtcblx0XHRcdHZhciBhY3Rpb25FdmVudCA9IHt9O1xuICAgXHRcdFx0YWN0aW9uRXZlbnQudGFyZ2V0SWQgPSBldmVudC50YXJnZXQuaWQ7XG4gICBcdFx0XHRhY3Rpb25FdmVudC5lbGVtZW50SWQgPSB0aGlzLmVsZW1lbnRJZDtcblx0XHRcdGJlYW4uZmlyZSh0aGlzLCBcImFjdGlvbi1jbGlja2VkXCIsIGFjdGlvbkV2ZW50KTtcblx0XHR9XG5cblx0fTtcblxuXHRyZXR1cm4gRWRpdE1lbnU7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgRWRpdE1lbnUgPSByZXF1aXJlKCcuL0VkaXRNZW51Jyk7XG4gICAgdmFyIHpJbmRleENvdW50ZXIgPSAxO1xuXHR2YXIgUG9zdGl0ID0gcmVxdWlyZSgnLi9lbGVtZW50cy9Qb3N0aXQnKTtcblx0dmFyIFBpY3R1cmUgPSByZXF1aXJlKCcuL2VsZW1lbnRzL1BpY3R1cmUnKTtcblx0dmFyIE1vdGlvbiA9IHJlcXVpcmUoJy4vZWxlbWVudHMvTW90aW9uJyk7XG5cblxuXHRmdW5jdGlvbiBFbGVtZW50KCRlbCxlbGVtZW50VHlwZSxwb3NpdGlvbixpZCkgeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0dGhpcy5lbGVtZW50VHlwZSA9IGVsZW1lbnRUeXBlO1xuXHRcdHRoaXMuZWxlbWVudElkID0gaWQ7XG5cdFx0aWYodGhpcy5lbGVtZW50SWQpe1xuXHRcdFx0dGhpcy5lbGVtZW50SWQgPSBpZDtcblx0XHR9ZWxzZSB7XG5cdFx0XHR0aGlzLmVsZW1lbnRJZCA9IGVsZW1lbnRUeXBlK1wiX1wiK3RoaXMuJGVsLmZpbmQoXCIuZWxlbWVudC1ob2xkZXJcIikubGVuZ3RoO1xuXHRcdH1cblxuXHRcdHRoaXMucG9zaXRpb24gPSBwb3NpdGlvbjtcblx0XHR0aGlzLmNyZWF0ZUVsZW1lbnRIb2xkZXIoKTtcblx0fVxuXG5cdEVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnRIb2xkZXIgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGNyZWF0ZUVsZW1lbnRIb2xkZXInKTtcblx0XHR0aGlzLiRlbC5maW5kKFwiI3doaXRlYm9hcmRcIikuYXBwZW5kKFwiPHNlY3Rpb24gY2xhc3M9J2VsZW1lbnQtaG9sZGVyJz48L3NlY3Rpb24+XCIpO1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIuZWxlbWVudC1ob2xkZXI6bGFzdC1vZi10eXBlXCIpLmF0dHIoJ2lkJywgdGhpcy5lbGVtZW50SWQpO1xuXHRcdHZhciBwb3NpdGlvbiA9IHtcblx0XHRcdHRvcCA6IHRoaXMucG9zaXRpb24ueVBvcyxcblx0XHRcdGxlZnQgOiB0aGlzLnBvc2l0aW9uLnhQb3MsXG5cdFx0XHR6SW5kZXg6IDBcblx0XHR9O1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpLmNzcyhwb3NpdGlvbik7XG5cdFx0dGhpcy5jcmVhdGVFZGl0TWVudSgpO1xuXHRcdHRoaXMuY3JlYXRlRWxlbWVudCgpO1xuXHR9O1xuXG5cdEVsZW1lbnQucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGNyZWF0ZUVsZW1lbnQnKTtcblx0XHRzd2l0Y2godGhpcy5lbGVtZW50VHlwZSkge1xuXHRcdCAgICBjYXNlIFwicG9zdC1pdFwiOlxuXHRcdCAgICBcdHRoaXMuZWxlbWVudCA9IG5ldyBQb3N0aXQoKTtcblx0XHQgICAgXHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKS5hcHBlbmQodGhpcy5lbGVtZW50LmNyZWF0ZVBvc3RpdCgpKTtcblx0XHQgICAgXHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKS5hcHBlbmQodGhpcy5lbGVtZW50LmNyZWF0ZVBvc3RpdCk7XG5cdFx0ICAgIFx0dGhpcy5iaW5kSGFuZGxlcih0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKSk7XG5cdFx0ICAgICAgICBicmVhaztcblx0XHQgICAgY2FzZSBcInN0YXRpY1wiOlxuXHRcdCAgICBcdHRoaXMuZWxlbWVudCA9IG5ldyBQaWN0dXJlKHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpKTtcblx0XHQgICAgXHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKS5hcHBlbmQodGhpcy5lbGVtZW50LmNyZWF0ZVBpY3R1cmUpO1xuXHRcdCAgICBcdHRoaXMuYmluZEhhbmRsZXIodGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkpO1xuXHRcdCAgICBcdHRoaXMuZWxlbWVudC5pbml0SW1hZ2VJbnB1dHMoKTtcblx0XHQgICAgICAgIGJyZWFrO1xuXHRcdCAgICBjYXNlIFwibW90aW9uXCI6XG5cdFx0ICAgIFx0dGhpcy5lbGVtZW50ID0gbmV3IE1vdGlvbih0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKSk7XG5cdFx0ICAgIFx0dGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkuYXBwZW5kKHRoaXMuZWxlbWVudC5jcmVhdGVNb3Rpb24pO1xuXHRcdCAgICBcdHRoaXMuYmluZEhhbmRsZXIodGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkpO1xuXHRcdCAgICBcdHRoaXMuZWxlbWVudC5pbml0TW90aW9uSW5wdXRzKCk7XG5cblx0XHQgICAgICAgIGJyZWFrO1xuXHRcdH1cblx0fTtcblxuXHRFbGVtZW50LnByb3RvdHlwZS5iaW5kSGFuZGxlciA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbRWxlbWVudF0gYmluZEhhbmRsZXInKTtcblx0XHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKS5vbignbW91c2Vkb3duJywgdGhpcy5tb3VzZWRvd25IYW5kbGVyLmJpbmQodGhpcykpO1xuXHRcdHRoaXMubW91c2VEb3duID0gZmFsc2U7XG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUubW91c2Vkb3duSGFuZGxlciA9IGZ1bmN0aW9uKGUpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIG1vdXNlZG93bkhhbmRsZXInKVxuXHRcdGlmKGUudGFyZ2V0LmlkICE9PSBcIndoaXRlYm9hcmRcIil7XG4gICAgICAgICAgICB0aGlzLiRlbC5maW5kKFwiI2VsZW1lbnQtcGlja2VyXCIpLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xuXHRcdH1cblxuICAgICAgICB0aGlzLm1vdXNlRG93biA9IHRydWU7XG4gICAgICAgIFxuICAgICAgICB0aGlzLl9tb3VzZU1vdmVIYW5kbGVyID0gdGhpcy5tb3VzZU1vdmVIYW5kbGVyLmJpbmQodGhpcyk7XG4gICAgICAgIHRoaXMuX21vdXNlVXBIYW5kbGVyID0gdGhpcy5tb3VzZVVwSGFuZGxlci5iaW5kKHRoaXMpO1xuXG4gICAgICAgIHRoaXMub2Zmc2V0WCA9IGUub2Zmc2V0WDtcbiAgICAgICAgdGhpcy5vZmZzZXRZID0gZS5vZmZzZXRZO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICArK3pJbmRleENvdW50ZXI7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignIycrdGhpcy5lbGVtZW50SWQpLnN0eWxlLnpJbmRleCA9IHpJbmRleENvdW50ZXI7XG4gICAgICAgIFxuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdXNlTW92ZUhhbmRsZXIpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl9tb3VzZVVwSGFuZGxlcik7XG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUuY3JlYXRlRWRpdE1lbnUgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGNyZWF0ZUVkaXRNZW51Jyk7XG5cdFx0dGhpcy5lZGl0TWVudSA9IG5ldyBFZGl0TWVudSh0aGlzLiRlbCwgdGhpcy5lbGVtZW50SWQpO1xuXHRcdGJlYW4ub24odGhpcy5lZGl0TWVudSwgXCJlZGl0LWNsaWNrZWRcIiwgdGhpcy5lZGl0Q2xpY2tlZEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0YmVhbi5vbih0aGlzLmVkaXRNZW51LCBcImFjdGlvbi1jbGlja2VkXCIsIHRoaXMuYWN0aW9uQ2xpY2tlZEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUuZWRpdENsaWNrZWRIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGVkaXRDbGlja2VkSGFuZGxlcicpO1xuXHRcdHRoaXMuZWxlbWVudC5lZGl0KHRoaXMuJGVsLCB0aGlzLmVsZW1lbnRJZCk7XG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUuYWN0aW9uQ2xpY2tlZEhhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbRWxlbWVudF0gYWN0aW9uQ2xpY2tlZEhhbmRsZXInKTtcblx0XHRzd2l0Y2goZXZlbnQudGFyZ2V0SWQpIHtcblx0XHQgICAgY2FzZSBcInJlbW92ZVwiOlxuXHRcdCAgICBcdHRoaXMuZWRpdE1lbnUudG9nZ2xlVmlzaWJsZSgpO1xuXHRcdCAgICBcdHRoaXMuJGVsLmZpbmQoJyMnK2V2ZW50LmVsZW1lbnRJZCkucmVtb3ZlKCk7XG5cdFx0ICAgICAgICBicmVhaztcblx0XHQgICAgY2FzZSBcImVkaXRcIjogY29uc29sZS5sb2coXCJFRElURVwiKTtcblx0XHQgICAgXHR0aGlzLmVsZW1lbnQuY29uZmlybSgpO1xuXHRcdCAgICBcdHRoaXMuZWRpdE1lbnUudG9nZ2xlVmlzaWJsZSgpO1xuXHRcdCAgICAgICAgYnJlYWs7XG5cdFx0ICAgIGNhc2UgXCJjYW5jZWxcIjpcblx0XHQgICAgXHR0aGlzLmVsZW1lbnQuZW5kRWRpdCgpO1xuXHRcdCAgICBcdHRoaXMuZWRpdE1lbnUudG9nZ2xlVmlzaWJsZSgpO1xuXHRcdCAgICAgICAgYnJlYWs7XG5cdFx0fVxuXHR9O1xuICAgIEVsZW1lbnQucHJvdG90eXBlLm1vdXNlTW92ZUhhbmRsZXIgPSBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coJ1tFbGVtZW50XSBtb3VzZW1vdmVIYW5kbGVyJyk7XG4gICAgICAgIGlmKHRoaXMubW91c2VEb3duID09PSB0cnVlKXtcblxuICAgICAgICAgICAgdmFyIG1vdXNlWCA9IHBhcnNlSW50KGUuY2xpZW50WCk7XG4gICAgICAgICAgICB2YXIgbW91c2VZID0gcGFyc2VJbnQoZS5jbGllbnRZKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjJyt0aGlzLmVsZW1lbnRJZCkuc3R5bGUubGVmdCA9IChtb3VzZVggLSB0aGlzLm9mZnNldFgpICsgXCJweFwiO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjJyt0aGlzLmVsZW1lbnRJZCkuc3R5bGUudG9wID0gKG1vdXNlWSAtIHRoaXMub2Zmc2V0WSkgKyBcInB4XCI7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgRWxlbWVudC5wcm90b3R5cGUubW91c2VVcEhhbmRsZXIgPSBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coJ1tFbGVtZW50XSBtb3VzZXVwSGFuZGxlcicpO1xuXG4gICAgICAgIHRoaXMubW91c2VEb3duID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdXNlTW92ZUhhbmRsZXIpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl9tb3VzZVVwSGFuZGxlcik7XG4gICAgfTtcblxuXHRyZXR1cm4gRWxlbWVudDtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cblx0ZnVuY3Rpb24gRWxlbWVudFBpY2tlcigkZWwpIHsgY29uc29sZS5sb2coJ1tFbGVtZW50UGlja2VyXSBjb25zdHJ1Y3RvcicpO1xuXHRcdHRoaXMuJGVsID0gJGVsO1xuXHRcdGNvbnNvbGUubG9nKCRlbCk7XG5cdFx0dmFyIGVudHJ5VGV4dCA9ICQoJyNlbGVtZW50LXBpY2tlci10ZW1wbGF0ZScpLnRleHQoKTtcblx0XHR2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoZW50cnlUZXh0KTtcblx0XHR2YXIgY29udGV4dCA9IHtcblx0XHQgIGVsZW1lbnRzOiBbXHRcblx0XHQgIFx0XHRcdHtlbGVtZW50OiBcInBvc3QtaXRcIiwgbmFtZTogXCJwb3N0LWl0XCJ9LFxuXHRcdCAgXHRcdFx0e2VsZW1lbnQ6IFwic3RhdGljXCIsIG5hbWU6IFwiaW1hZ2VcIn0sXG5cdFx0ICBcdFx0XHR7ZWxlbWVudDogXCJtb3Rpb25cIiwgbmFtZTogXCJ2aWRlb1wifVxuICBcdFx0XHRcdF1cbiAgXHRcdFx0fTtcblx0XHRcdEhhbmRsZWJhcnMucmVnaXN0ZXJIZWxwZXIoJ3BpY2tlcicsIGZ1bmN0aW9uKCkge1xuXHRcdFx0ICB2YXIgZWxlbWVudCA9IEhhbmRsZWJhcnMuZXNjYXBlRXhwcmVzc2lvbih0aGlzLmVsZW1lbnQpLFxuXHRcdFx0ICAgICAgbmFtZSA9IEhhbmRsZWJhcnMuZXNjYXBlRXhwcmVzc2lvbih0aGlzLm5hbWUpO1xuXG5cdFx0XHQgIHJldHVybiBuZXcgSGFuZGxlYmFycy5TYWZlU3RyaW5nKFxuXHRcdFx0ICAgIFwiPGxpIGlkPVwiK2VsZW1lbnQrXCI+XCIrbmFtZStcIjwvbGk+XCJcblx0XHRcdCAgKTtcblx0XHRcdH0pO1xuXHRcdFxuXHRcdHZhciBodG1sID0gdGVtcGxhdGUoY29udGV4dCk7XG5cdFx0dGhpcy4kZWwuZmluZChcIiN3aGl0ZWJvYXJkXCIpLmFwcGVuZCggJChodG1sKSApO1xuXHRcdHRoaXMudG9nZ2xlVmlzaWJsZSgpO1xuXHRcdHRoaXMuYmluZEhhbmRsZXIoKTtcblx0fVxuXG5cdEVsZW1lbnRQaWNrZXIucHJvdG90eXBlLnRvZ2dsZVZpc2libGUgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRQaWNrZXJdIHRvZ2dsZVZpc2libGUnKTtcblx0XHR0aGlzLiRlbC5maW5kKCcjZWxlbWVudC1waWNrZXInKS50b2dnbGVDbGFzcyhcImhpZGRlblwiKTtcblx0fTtcblxuXHRFbGVtZW50UGlja2VyLnByb3RvdHlwZS5zZXRMb2NhdGlvbiA9IGZ1bmN0aW9uKHhQb3MsIHlQb3MpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRQaWNrZXJdIHNldExvY2F0aW9uJyk7XG5cdFx0dmFyIHBvc2l0aW9uID0ge1xuXHRcdFx0dG9wIDogeVBvcyxcblx0XHRcdGxlZnQgOiB4UG9zXG5cdFx0fTtcblx0XHR0aGlzLiRlbC5maW5kKFwiI2VsZW1lbnQtcGlja2VyXCIpLmNzcyhwb3NpdGlvbik7XG5cdH07XG5cblx0RWxlbWVudFBpY2tlci5wcm90b3R5cGUuYmluZEhhbmRsZXIgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRQaWNrZXJdIGJpbmRIYW5kbGVyJyk7XG5cdFx0dGhpcy4kZWwuZmluZCgnI2VsZW1lbnQtcGlja2VyID4gdWwgPiBsaScpLm9uKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyLmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdEVsZW1lbnRQaWNrZXIucHJvdG90eXBlLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KXsgY29uc29sZS5sb2coJ1tFbGVtZW50UGlja2VyXSBjbGlja0hhbmRsZXInKTtcblx0XHRiZWFuLmZpcmUodGhpcywgXCJlbGVtZW50LXBpY2tlci1jbGlja2VkXCIsIGV2ZW50LnRhcmdldC5pZCk7XG5cdH07XG5cblx0cmV0dXJuIEVsZW1lbnRQaWNrZXI7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgV2hpdGVib2FyZFNldHRpbmdzID0gcmVxdWlyZSAoJy4vV2hpdGVib2FyZFNldHRpbmdzJyk7XG5cblx0ZnVuY3Rpb24gV2hpdGVib2FyZCgkZWwsIGJvYXJkTmFtZSkgeyBjb25zb2xlLmxvZygnW1doaXRlYm9hcmRdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0Lypcblx0XHRpZihib2FyZE5hbWUpe1xuXHRcdFx0dGhpcy5ib2FyZE5hbWUgPSBib2FyZE5hbWU7XG5cdFx0fWVsc2V7XG5cdFx0XHR0aGlzLmJvYXJkTmFtZSA9IFwiTmlldXcgYm9hcmRcIjtcblx0XHR9XG5cdFx0Ki9cblx0XHR0aGlzLmNyZWF0ZVdoaXRlYm9hcmQoKTtcblx0XHQvL3RoaXMuYWRkV2hpdGVib2FyZFNldHRpbmdzKCk7XG5cblx0fVxuXG5cdFdoaXRlYm9hcmQucHJvdG90eXBlLmNyZWF0ZVdoaXRlYm9hcmQgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW1doaXRlYm9hcmRdIGNyZWF0ZVdoaXRlYm9hcmQnKTtcblx0XHR0aGlzLmJvYXJkID0gdGhpcy4kZWwuYXBwZW5kKFwiPGRpdiBpZD0nd2hpdGVib2FyZCc+PC9kaXY+XCIpO1xuXHRcdHRoaXMuYmluZEhhbmRsZXIoKTtcblx0fTtcblxuXHRXaGl0ZWJvYXJkLnByb3RvdHlwZS5iaW5kSGFuZGxlciA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbV2hpdGVib2FyZF0gYmluZEhhbmRsZXInKTtcblx0XHR0aGlzLmJvYXJkLm9uKCdjbGljaycsIHRoaXMuY2xpY2tIYW5kbGVyLmJpbmQodGhpcykpO1xuXHR9O1xuXG5cdFdoaXRlYm9hcmQucHJvdG90eXBlLmNsaWNrSGFuZGxlciA9IGZ1bmN0aW9uKGV2ZW50KXsgY29uc29sZS5sb2coJ1tXaGl0ZWJvYXJkXSBjbGlja0hhbmRsZXInKTtcblx0XHR2YXIgeFBvcyA9IGV2ZW50LnBhZ2VYIC0gdGhpcy4kZWwub2Zmc2V0KCkubGVmdDtcbiAgIFx0XHR2YXIgeVBvcyA9IGV2ZW50LnBhZ2VZIC0gdGhpcy4kZWwub2Zmc2V0KCkudG9wO1xuICAgXHRcdHZhciBwb3NpdGlvbiA9IHt9O1xuICAgXHRcdHBvc2l0aW9uLnhQb3MgPSB4UG9zO1xuICAgXHRcdHBvc2l0aW9uLnlQb3MgPSB5UG9zO1xuXHRcdGlmKGV2ZW50LnRhcmdldC5pZCA9PT0gXCJ3aGl0ZWJvYXJkXCIpeyAvL2FuZGVycyBrbGlrdCBoaWogXCJkb29yXCIgZWxlbWVudGVuXG5cdFx0XHRiZWFuLmZpcmUodGhpcywgXCJ3aGl0ZWJvYXJkLWNsaWNrZWRcIiwgcG9zaXRpb24pO1xuXHRcdH1cblx0fTtcblxuXHRXaGl0ZWJvYXJkLnByb3RvdHlwZS5hZGRXaGl0ZWJvYXJkU2V0dGluZ3MgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW1doaXRlYm9hcmRdIGFkZFdoaXRlYm9hcmRTZXR0aW5ncycpO1xuXHRcdHRoaXMud2hpdGVib2FyZFNldHRpbmdzID0gbmV3IFdoaXRlYm9hcmRTZXR0aW5ncyh0aGlzLiRlbCk7XG5cdFx0dGhpcy53aGl0ZWJvYXJkU2V0dGluZ3MuY3JlYXRlU2V0dGluZ1BhbmVsKCk7XG5cdFx0dGhpcy53aGl0ZWJvYXJkU2V0dGluZ3MuYWRkQ29udHJpYnV0b3IoKTtcblx0fTtcblxuXHRyZXR1cm4gV2hpdGVib2FyZDtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cdHZhciBBZGRDb250cmlidXRvciA9IHJlcXVpcmUoJy4vQWRkQ29udHJpYnV0b3InKTtcblxuXHRmdW5jdGlvbiBXaGl0ZWJvYXJkU2V0dGluZ3MoJGVsLCBjb250cmlidXRvcnMsIHByamN0X3RpdGxlKSB7IGNvbnNvbGUubG9nKCdbV2hpdGVib2FyZFNldHRpbmdzXSBjb25zdHJ1Y3RvcicpO1xuXHRcdHRoaXMuJGVsID0gJGVsO1xuXHRcdHRoaXMuY29udHJpYnV0b3JzID0gY29udHJpYnV0b3JzO1xuXHRcdGlmKHByamN0X3RpdGxlKXtcblx0XHRcdHRoaXMucHJqY3RfdGl0bGUgPSBwcmpjdF90aXRsZTtcblx0XHR9XG5cblx0fVxuXG5cdFdoaXRlYm9hcmRTZXR0aW5ncy5wcm90b3R5cGUuY3JlYXRlU2V0dGluZ1BhbmVsID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tXaGl0ZWJvYXJkU2V0dGluZ3NdIGNyZWF0ZVNldHRpbmdQYW5lbCcpO1xuXHRcdHZhciBlbnRyeVRleHQgPSAkKCcjc2V0dGluZy10ZW1wbGF0ZScpLnRleHQoKTtcblx0XHR2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoZW50cnlUZXh0KTtcblx0XHR2YXIgY29udGV4dCA9IHt9O1xuXG5cdFx0aWYodGhpcy5wcmpjdF90aXRsZSl7XG5cdFx0XHRjb250ZXh0LnByamN0X3RpdGxlID0gdGhpcy5wcmpjdF90aXRsZTtcblx0XHR9ZWxzZXtcblx0XHRcdGNvbnRleHQucHJqY3RfdGl0bGUgPSBcIlVudGl0bGVkXCI7XG5cdFx0fVxuXG5cdFx0Y29udGV4dC5jb250cmlidXRvciA9IHRoaXMuY29udHJpYnV0b3I7XG5cblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXHRcdCQoJyN3aGl0ZWJvYXJkJykuYXBwZW5kKCAkKGh0bWwpICk7XG5cdH07XG5cblx0V2hpdGVib2FyZFNldHRpbmdzLnByb3RvdHlwZS5hZGRDb250cmlidXRvciA9IGZ1bmN0aW9uKCl7Y29uc29sZS5sb2coJ1tXaGl0ZWJvYXJkU2V0dGluZ3NdIGFkZENvbnRyaWJ1dG9yJyk7XG5cdFx0dGhpcy5hZGRDb250cmlidXRvciA9IG5ldyBBZGRDb250cmlidXRvcih0aGlzLiRlbC5maW5kKCcuY29udHJpYnV0b3ItZm9ybScpKTtcblx0XHRjb25zb2xlLmxvZyh0aGlzLiRlbCk7XG5cdFx0Ly90aGlzLkFkZENvbnRyaWJ1dG9yLmNyZWF0ZVNldHRpbmdQYW5lbCgpO1xuXHR9O1xuXG5cdHJldHVybiBXaGl0ZWJvYXJkU2V0dGluZ3M7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHRmdW5jdGlvbiBNb3Rpb24oJGVsLHhQb3MseVBvcyx2aWRTcmMpIHsgY29uc29sZS5sb2coJ1tNb3Rpb25dIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0Y29uc29sZS5sb2coJGVsKTtcblx0XHRpZih2aWRTcmMpe1xuXHRcdHRoaXMudmlkU3JjID0gdmlkU3JjO1xuXHRcdH07XG5cblx0XHRpZiAoXG5cdFx0XHR3aW5kb3cuRmlsZSAmJiBcblx0XHRcdHdpbmRvdy5GaWxlUmVhZGVyICYmIFxuXHRcdFx0d2luZG93LkZpbGVMaXN0ICYmIFxuXHRcdFx0d2luZG93LkJsb2Jcblx0XHQpIHtcblxuXHRcdH07XG5cdH1cblxuXHRNb3Rpb24ucHJvdG90eXBlLmNyZWF0ZU1vdGlvbiA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbTW90aW9uXSBjcmVhdE1vdGlvbicpO1xuXHRcdHZhciBlbnRyeVRleHQgPSAkKCcjbW90aW9uLXRlbXBsYXRlJykudGV4dCgpO1xuXHRcdHZhciB0ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShlbnRyeVRleHQpO1xuXHRcdHZhciBjb250ZXh0ID0ge307XG5cblx0XHRpZih0aGlzLnR4dCl7XG5cdFx0XHRjb250ZXh0LnZpZFNyYyA9IHRoaXMudmlkU3JjO1xuXHRcdH1lbHNle1xuXHRcdFx0Y29udGV4dC52aWRTcmMgPSBcIlwiO1xuXHRcdH1cblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXHRcdHJldHVybigkKGh0bWwpKTtcblxuXHR9O1xuXG5cdFxuXHRNb3Rpb24ucHJvdG90eXBlLmluaXRNb3Rpb25JbnB1dHM9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbTW90aW9uXSBpbml0TW90aW9uSW5wdXRzJyk7XG5cdFx0XHR2YXIgbW90aW9uSW5wdXRzID0gdGhpcy4kZWwuZmluZCgnLm1vdGlvbi1pbnB1dCcpWzBdO1xuXHRcdFx0aW5pdE1vdGlvbklucHV0KG1vdGlvbklucHV0cyk7XG5cdH07XG5cdFxuXHRmdW5jdGlvbiBpbml0TW90aW9uSW5wdXQoZWwpeyAgY29uc29sZS5sb2coJ1tNb3Rpb25dIGluaXRNb3Rpb25JbnB1dCcpO1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoJ21vdGlvbi1pbnB1dC1qcycpO1xuXG5cdFx0dmFyIGZpbGVJbnB1dCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W3R5cGU9ZmlsZV0nKTtcblx0XHRmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgY3JlYXRlVGh1bWIpO1xuXHRcdFxuXHRcdHZhciBwcmV2aWV3Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0cHJldmlld0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdtb3Rpb24taW5wdXQtcHJldmlldycpO1xuXG5cdFx0XG5cdFx0ZWwuaW5zZXJ0QmVmb3JlKHByZXZpZXdDb250YWluZXIsIGZpbGVJbnB1dCk7XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNyZWF0ZVRodW1iKGUpe1xuXHRcdGNvbnNvbGUubG9nKFwiSW5wdXQgY2hhbmdlZFwiKTtcblxuXHRcdGlmIChcblx0XHRcdHRoaXMuZmlsZXMgJiYgXG5cdFx0XHR0aGlzLmZpbGVzWzBdICYmIFxuXHRcdFx0dGhpcy5maWxlc1swXS50eXBlLm1hdGNoKCd2aWRlby4qJylcblx0XHQpIHtcblx0XHRcdHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXHRcdFx0dmFyIHByZXZpZXdDb250YWluZXIgPSB0aGlzLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLm1vdGlvbi1pbnB1dC1wcmV2aWV3Jyk7XG5cblx0XHRcdFx0cmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHR2YXIgdmlkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndmlkZW8nKTtcblxuXHRcdFx0XHR2aWQub25sb2FkID0gZnVuY3Rpb24oKXtcblx0XHRcdFx0Y29uc29sZS5sb2codmlkKTtcblxuXHRcdFx0XHRcdGlmKHZpZC53aWR0aCA+IDMwMCApe1xuXHRcdFx0XHRcdFx0bmV3V2lkdGggPSB2aWQud2lkdGgvaW1nLndpZHRoKjMwMDtcblx0XHRcdFx0XHRcdG5ld0hlaWdodCA9IHZpZC5oZWlnaHQvaW1nLndpZHRoKjMwMDtcblx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdG5ld1dpZHRoID0gdmlkLndpZHRoO1xuXHRcdFx0XHRcdFx0bmV3SGVpZ2h0ID0gdmlkLmhlaWdodDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZihlcnJvcnMubGVuZ3RoID09PSAwKXtcblx0XHRcdFx0XHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuc3JjID0gXCInXCIrIGUudGFyZ2V0LnJlc3VsdCArXCInXCI7XG5cdFx0XHRcdFx0XHQvL3ByZXZpZXdDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbmV3SGVpZ2h0O1xuXHRcdFx0XHRcdFx0Ly9wcmV2aWV3Q29udGFpbmVyLnN0eWxlLndpZHRoID0gbmV3V2lkdGg7XG5cblxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHRhbGVydChlcnJvcnMuam9pbihcIlxcblwiKSk7XG5cdFx0XHRcdFx0XHRlcnJvcnMgPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0dmlkLnNldEF0dHJpYnV0ZSgnc3JjJywgZS50YXJnZXQucmVzdWx0KTtcblx0XHRcdFx0Ly92aWQuc2V0QXR0cmlidXRlKCd3aWR0aCcsIG5ld0hlaWdodCk7XG5cdFx0XHRcdC8vdmlkLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgbmV3SGVpZ2h0KTtcblxuXHRcdFx0fVxuXG5cdFx0XHQvL3JlYWRlci5VUkwuY3JlYXRlT2JqZWN0VVJMKHRoaXMuZmlsZXNbMF0pO1xuXHRcdFx0cmVhZGVyLnJlYWRBc0RhdGFVUkwodGhpcy5maWxlc1swXSk7XG5cdFx0fWVsc2V7XG5cdFx0XHRlcnJvcnMucHVzaChcIkZpbGUgaXMgbm90IGEgdmFsaWQgdmlkZW9cIik7XG5cdFx0fVxuXHRcdFxuXHR9XG5cdFxuXHRmdW5jdGlvbiBjaGVja0Vycm9ycygpe1xuXHRcdGlmKGVycm9ycy5sZW5ndGggPT09IDApe1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1lbHNle1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHR9XG5cblxuXHRyZXR1cm4gTW90aW9uO1xuXG59KSgpOyIsIm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCl7XG5cdHZhciBlcnJvcnMgPSBbXTtcblxuXHRmdW5jdGlvbiBQaWN0dXJlKCRlbCx4UG9zLHlQb3MsIGltZ1NyYykgeyBjb25zb2xlLmxvZygnW1BpY3R1cmVdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0Y29uc29sZS5sb2coJGVsKTtcblx0XHRpZihpbWdTcmMpe1xuXHRcdHRoaXMuaW1nU3JjID0gaW1nU3JjO1xuXHRcdH07XG5cblx0XHRpZiAoXG5cdFx0XHR3aW5kb3cuRmlsZSAmJiBcblx0XHRcdHdpbmRvdy5GaWxlUmVhZGVyICYmIFxuXHRcdFx0d2luZG93LkZpbGVMaXN0ICYmIFxuXHRcdFx0d2luZG93LkJsb2Jcblx0XHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiRnVsbCBmaWxlIHN1cHBvcnRcIik7XG5cblx0XHR9O1xuXHR9XG5cblx0UGljdHVyZS5wcm90b3R5cGUuY3JlYXRlUGljdHVyZSA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbUGljdHVyZV0gY3JlYXRQaWN0dXJlJyk7XG5cdFx0dmFyIGVudHJ5VGV4dCA9ICQoJyNwaWN0dXJlLXRlbXBsYXRlJykudGV4dCgpO1xuXHRcdHZhciB0ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShlbnRyeVRleHQpO1xuXHRcdHZhciBjb250ZXh0ID0ge307XG5cblx0XHRpZih0aGlzLnR4dCl7XG5cdFx0XHRjb250ZXh0LmltZ1NyYyA9IHRoaXMuaW1nU3JjO1xuXHRcdH1lbHNle1xuXHRcdFx0Y29udGV4dC5pbWdTcmMgPSBcIlwiO1xuXHRcdH1cblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXHRcdHJldHVybigkKGh0bWwpKTtcblxuXHR9O1xuXG5cdFxuXHRQaWN0dXJlLnByb3RvdHlwZS5pbml0SW1hZ2VJbnB1dHM9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbUGljdHVyZV0gaW5pdEltYWdlaW5wdXRzJyk7XG5cdFx0XHR2YXIgaW1nSW5wdXRzID0gdGhpcy4kZWwuZmluZCgnLmltYWdlLWlucHV0JylbMF07XG5cdFx0XHRpbml0SW1hZ2VJbXB1dChpbWdJbnB1dHMpO1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gaW5pdEltYWdlSW1wdXQoZWwpe1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoJ2ltYWdlLWlucHV0LWpzJyk7XG5cblx0XHR2YXIgZmlsZUlucHV0ID0gZWwucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1maWxlXScpO1xuXHRcdGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjcmVhdGVUaHVtYik7XG5cdFx0XG5cdFx0dmFyIHByZXZpZXdDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRwcmV2aWV3Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2ltYWdlLWlucHV0LXByZXZpZXcnKTtcblxuXHRcdFxuXHRcdGVsLmluc2VydEJlZm9yZShwcmV2aWV3Q29udGFpbmVyLCBmaWxlSW5wdXQpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVUaHVtYihlKXtcblx0XHRjb25zb2xlLmxvZyhcIklucHV0IGNoYW5nZWRcIik7XG5cblx0XHRpZiAoXG5cdFx0XHR0aGlzLmZpbGVzICYmIFxuXHRcdFx0dGhpcy5maWxlc1swXSAmJiBcblx0XHRcdHRoaXMuZmlsZXNbMF0udHlwZS5tYXRjaCgnaW1hZ2UuKicpXG5cdFx0KSB7XG5cdFx0XHR2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdHZhciBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1pbnB1dC1wcmV2aWV3Jyk7XG5cblx0XHRcdHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKXtcblx0XHRcdFx0dmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuXG5cdFx0XHRcdGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xuXG5cdFx0XHRcdFx0aWYoaW1nLndpZHRoID4gMzAwICl7XG5cdFx0XHRcdFx0XHRuZXdXaWR0aCA9IGltZy53aWR0aC9pbWcud2lkdGgqMzAwO1xuXHRcdFx0XHRcdFx0bmV3SGVpZ2h0ID0gaW1nLmhlaWdodC9pbWcud2lkdGgqMzAwO1xuXHRcdFx0XHRcdH1lbHNle1xuXHRcdFx0XHRcdFx0bmV3V2lkdGggPSBpbWcud2lkdGg7XG5cdFx0XHRcdFx0XHRuZXdIZWlnaHQgPSBpbWcuaGVpZ2h0O1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmKGVycm9ycy5sZW5ndGggPT09IDApe1xuXHRcdFx0XHRcdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBcInVybCgnXCIrIGUudGFyZ2V0LnJlc3VsdCArXCInKVwiO1xuXHRcdFx0XHRcdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS5oZWlnaHQgPSBuZXdIZWlnaHQrXCJweFwiO1xuXHRcdFx0XHRcdFx0cHJldmlld0NvbnRhaW5lci5zdHlsZS53aWR0aCA9IG5ld1dpZHRoK1wicHhcIjtcblxuXG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdGFsZXJ0KGVycm9ycy5qb2luKFwiXFxuXCIpKTtcblx0XHRcdFx0XHRcdGVycm9ycyA9IFtdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRcblx0XHRcdFx0aW1nLnNldEF0dHJpYnV0ZSgnc3JjJywgZS50YXJnZXQucmVzdWx0KTtcblx0XHRcdFx0aW1nLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCBpbWcud2lkdGgpO1xuXHRcdFx0XHRpbWcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBpbWcuaGVpZ2h0KTtcblx0XHRcdH1cblxuXHRcdFx0cmVhZGVyLnJlYWRBc0RhdGFVUkwodGhpcy5maWxlc1swXSk7XG5cblx0XHR9ZWxzZXtcblx0XHRcdGVycm9ycy5wdXNoKFwiRmlsZSBpcyBub3QgYSB2YWxpZCBpbWFnZVwiKTtcblx0XHR9XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNoZWNrRXJyb3JzKCl7XG5cdFx0aWYoZXJyb3JzLmxlbmd0aCA9PT0gMCl7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fWVsc2V7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRQaWN0dXJlLnByb3RvdHlwZS5lZGl0ID0gZnVuY3Rpb24oJGVsLGVsZW1lbnRJZCl7IGNvbnNvbGUubG9nKCdbUGljdHVyZV0gZWRpdCcpO1xuXHR9O1xuXG5cdFBpY3R1cmUucHJvdG90eXBlLmNvbmZpcm0gPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW1BpY3R1cmVdIGNvbmZpcm0nKTtcblx0fTtcblxuXHRQaWN0dXJlLnByb3RvdHlwZS5lbmRFZGl0ID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tQaWN0dXJlXSBlbmRFZGl0Jyk7XG5cdH07XG5cblx0cmV0dXJuIFBpY3R1cmU7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgUG9zdGl0RWRpdCA9IHJlcXVpcmUoJy4vUG9zdGl0RWRpdCcpO1xuXG5cdGZ1bmN0aW9uIFBvc3RpdCh0eHQpIHsgY29uc29sZS5sb2coJ1tQb3N0aXRdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy50eHQgPSB0eHQ7XG5cdFx0aWYoIXRoaXMudHh0KXtcblx0XHRcdHRoaXMudHh0ID0gXCJOaWV1d2UgUG9zdGl0XCI7XG5cdFx0fVxuXHR9XG5cblx0UG9zdGl0LnByb3RvdHlwZS5jcmVhdGVQb3N0aXQgPSBmdW5jdGlvbih0eHQpeyBjb25zb2xlLmxvZygnW1Bvc3RpdF0gY3JlYXRlUG9zdGl0Jyk7XG5cdFx0dmFyIGVudHJ5VGV4dCA9ICQoJyNwb3N0aXQtdGVtcGxhdGUnKS50ZXh0KCk7XG5cdFx0dmFyIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKGVudHJ5VGV4dCk7XG5cdFx0dmFyIGNvbnRleHQgPSB7fTtcblx0XHRjb250ZXh0LnR4dCA9IHRoaXMudHh0O1xuXHRcdHZhciBodG1sID0gdGVtcGxhdGUoY29udGV4dCk7XG5cdFx0cmV0dXJuICgkKGh0bWwpKTtcblx0fTtcblxuXHRQb3N0aXQucHJvdG90eXBlLmVkaXQgPSBmdW5jdGlvbigkZWwsZWxlbWVudElkKXsgY29uc29sZS5sb2coJ1tQb3N0aXRdIGVkaXQnKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHR0aGlzLmVsZW1lbnRJZCA9IGVsZW1lbnRJZDtcblx0XHR0aGlzLiRlbC5maW5kKFwiI1wiK2VsZW1lbnRJZCtcIiA+IC5wb3N0aXQgPiBwXCIpLnRvZ2dsZUNsYXNzKFwiaGlkZGVuXCIpO1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIjXCIrZWxlbWVudElkKS5hcHBlbmQobmV3IFBvc3RpdEVkaXQodGhpcy50eHQpKTtcblx0fTtcblxuXHRQb3N0aXQucHJvdG90eXBlLmNvbmZpcm0gPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW1Bvc3RpdF0gY29uZmlybScpO1xuXHRcdHRoaXMudHh0ID0gdGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCtcIiAucG9zdGl0LWVkaXRcIikudmFsKCk7XG5cdFx0dGhpcy5lbmRFZGl0KCk7XG5cdH07XG5cblx0UG9zdGl0LnByb3RvdHlwZS5lbmRFZGl0ID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tQb3N0aXRdIGVuZEVkaXQnKTtcblx0XHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkK1wiID4gLnBvc3RpdCA+IHBcIikuYWRkQ2xhc3MoXCJoaWRkZW5cIikudGV4dCh0aGlzLnR4dCk7XG5cdFx0dGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCtcIiA+IC5wb3N0aXQtZWRpdFwiKS5yZW1vdmUoKTtcblx0XHR0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkK1wiID4gLnBvc3RpdCA+IHBcIikudG9nZ2xlQ2xhc3MoXCJoaWRkZW5cIik7XG5cdH07XG5cblx0cmV0dXJuIFBvc3RpdDtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cdGZ1bmN0aW9uIFBvc3RpdEVkaXQodHh0KSB7IGNvbnNvbGUubG9nKCdbUG9zdGl0RWRpdF0gY29uc3RydWN0b3InKTtcblx0XHR2YXIgZW50cnlUZXh0ID0gJCgnI3Bvc3RpdC1lZGl0LXRlbXBsYXRlJykudGV4dCgpO1xuXHRcdHZhciB0ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShlbnRyeVRleHQpO1xuXHRcdHZhciBjb250ZXh0ID0ge307XG5cdFx0Y29udGV4dC50eHQgPSB0eHQ7XG5cblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXG5cdFx0cmV0dXJuICgkKGh0bWwpKTtcblxuXHR9XG5cdFxuXHRyZXR1cm4gUG9zdGl0RWRpdDtcblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=