!function e(t,i,n){function o(s,l){if(!i[s]){if(!t[s]){var c="function"==typeof require&&require;if(!l&&c)return c(s,!0);if(r)return r(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var a=i[s]={exports:{}};t[s][0].call(a.exports,function(e){var i=t[s][1][e];return o(i?i:e)},a,a.exports,e,t,i,n)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e){!function(){function t(){new i($("#container"))}var i=e("./classes/App");t()}()},{"./classes/App":3}],2:[function(e,t){t.exports=function(){function e(e){console.log("[AddContributor] constructor"),this.$el=e,this.input=this.$el.find(".input-contributor")[0],this.$el.find(".input-contributor")[0].addEventListener("submit",this.submitHandler.bind(this))}return e.prototype.submitHandler=function(e){e.preventDefault(),console.log("SUBMUT"),this.input.value=""},e}()},{}],3:[function(e,t){t.exports=function(){function t(e){console.log("[App] constructor"),this.$el=e,this.position={},this.whiteboard=new i(this.$el),this.elementPicker=new n(this.$el),bean.on(this.whiteboard,"whiteboard-clicked",this.whiteboardClickedHandler.bind(this)),bean.on(this.elementPicker,"element-picker-clicked",this.elementPickerClickedHandler.bind(this))}var i=e("./Whiteboard"),n=e("./ElementPicker"),o=e("./Element");return t.prototype.whiteboardClickedHandler=function(e){console.log("[App] whiteboardClickedHandler"),this.elementPicker.toggleVisible(),this.elementPicker.setLocation(e.xPos,e.yPos),this.position=e},t.prototype.elementPickerClickedHandler=function(e){console.log("[App] elementPickerClickedHandler"),this.elementPicker.toggleVisible();new o(this.$el,e,this.position)},t}()},{"./Element":4,"./ElementPicker":5,"./Whiteboard":6}],4:[function(e,t){t.exports=function(){function t(e,t,i,n){console.log("[Element] constructor"),this.$el=e,this.elementType=t,this.elementId=n,this.elementId=this.elementId?t+"_"+n:t+"_"+this.$el.find(".element-holder").length,this.position=i,this.createElementHolder()}var i=1,n=e("./elements/Postit"),o=e("./elements/Picture"),r=e("./elements/Motion");return t.prototype.createElementHolder=function(){console.log("[Element] createElementHolder"),this.$el.find("#whiteboard").append("<section class='element-holder "+this.elementType+"'></section>"),this.$el.find(".element-holder:last-of-type").attr("id",this.elementId);var e={top:this.position.yPos,left:this.position.xPos,zIndex:0};this.$el.find("#"+this.elementId).css(e),this.createElement()},t.prototype.createElement=function(){switch(console.log("[Element] createElement"),this.elementType){case"post-it":this.element=new n,this.$el.find("#"+this.elementId).append(this.element.createPostit),this.bindHandler(this.$el.find("#"+this.elementId));break;case"static":this.element=new o(this.$el.find("#"+this.elementId)),this.$el.find("#"+this.elementId).append(this.element.createPicture),this.bindHandler(this.$el.find("#"+this.elementId)),this.element.initImageInputs();break;case"motion":this.element=new r,this.$el.find("#"+this.elementId).append(this.element.createMotion),this.bindHandler(this.$el.find("#"+this.elementId))}},t.prototype.bindHandler=function(){console.log("[Element] bindHandler"),this.$el.find("#"+this.elementId).on("mousedown",this.mousedownHandler.bind(this)),this.mouseDown=!1},t.prototype.mousedownHandler=function(e){console.log("[Element] mousedownHandler"),this.mouseDown=!0,this._mouseMoveHandler=this.mouseMoveHandler.bind(this),this._mouseUpHandler=this.mouseUpHandler.bind(this),this.offsetX=e.offsetX,this.offsetY=e.offsetY,++i,document.body.querySelector("#"+this.elementId).style.zIndex=i,document.body.addEventListener("mousemove",this._mouseMoveHandler),document.body.addEventListener("mouseup",this._mouseUpHandler)},t.prototype.mouseMoveHandler=function(e){if(console.log("[Element] mousemoveHandler"),this.mouseDown===!0){var t=parseInt(e.clientX),i=parseInt(e.clientY);document.body.querySelector("#"+this.elementId).style.left=t-this.offsetX+"px",document.body.querySelector("#"+this.elementId).style.top=i-this.offsetY+"px"}},t.prototype.mouseUpHandler=function(){console.log("[Element] mouseupHandler"),this.mouseDown=!1,document.body.querySelector("#"+this.elementId).removeEventListener("mousemove",this._mouseMoveHandler),document.body.querySelector("#"+this.elementId).removeEventListener("mouseup",this._mouseUpHandler)},t}()},{"./elements/Motion":8,"./elements/Picture":9,"./elements/Postit":10}],5:[function(e,t){t.exports=function(){function e(e){console.log("[ElementPicker] constructor"),this.$el=e,console.log(e);var t=$("#element-picker-template").text(),i=Handlebars.compile(t),n={elements:[{element:"post-it",name:"post-it"},{element:"static",name:"image"},{element:"motion",name:"video"}]};Handlebars.registerHelper("picker",function(){var e=Handlebars.escapeExpression(this.element),t=Handlebars.escapeExpression(this.name);return new Handlebars.SafeString("<li id="+e+">"+t+"</li>")});var o=i(n);this.$el.find("#whiteboard").append($(o)),this.toggleVisible(),this.bindHandler()}return e.prototype.toggleVisible=function(){console.log("[ElementPicker] toggleVisible"),this.$el.find("#element-picker").toggleClass("hidden")},e.prototype.setLocation=function(e,t){console.log("[ElementPicker] setLocation");var i={top:t,left:e};this.$el.find("#element-picker").css(i)},e.prototype.bindHandler=function(){console.log("[ElementPicker] bindHandler"),this.$el.find("#element-picker > ul > li").on("click",this.clickHandler.bind(this))},e.prototype.clickHandler=function(e){console.log("[ElementPicker] clickHandler"),bean.fire(this,"element-picker-clicked",e.target.id)},e}()},{}],6:[function(e,t){t.exports=function(){function t(e){console.log("[Whiteboard] constructor"),this.$el=e,this.createWhiteboard(),this.addWhiteboardSettings()}var i=e("./WhiteboardSettings");return t.prototype.createWhiteboard=function(){console.log("[Whiteboard] createWhiteboard"),this.board=this.$el.append("<article id='whiteboard'></article>"),this.bindHandler()},t.prototype.bindHandler=function(){console.log("[Whiteboard] bindHandler"),this.board.on("click",this.clickHandler.bind(this))},t.prototype.clickHandler=function(e){console.log("[Whiteboard] clickHandler");var t=e.pageX-this.$el.offset().left,i=e.pageY-this.$el.offset().top,n={};n.xPos=t,n.yPos=i,"whiteboard"===e.target.id&&bean.fire(this,"whiteboard-clicked",n)},t.prototype.addWhiteboardSettings=function(){console.log("[Whiteboard] addWhiteboardSettings"),this.whiteboardSettings=new i(this.$el),this.whiteboardSettings.createSettingPanel(),this.whiteboardSettings.addContributor()},t}()},{"./WhiteboardSettings":7}],7:[function(e,t){t.exports=function(){function t(e,t,i){console.log("[WhiteboardSettings] constructor"),this.$el=e,this.contributors=t,i&&(this.prjct_title=i)}var i=e("./AddContributor");return t.prototype.createSettingPanel=function(){console.log("[WhiteboardSettings] createSettingPanel");var e=$("#setting-template").text(),t=Handlebars.compile(e),i={};i.prjct_title=this.prjct_title?this.prjct_title:"Untitled",i.contributor=this.contributor;var n=t(i);$("#whiteboard").append($(n))},t.prototype.addContributor=function(){console.log("[WhiteboardSettings] addContributor"),this.addContributor=new i(this.$el.find(".contributor-form")),console.log(this.$el)},t}()},{"./AddContributor":2}],8:[function(e,t){t.exports=function(){function e(e,t,i,n){console.log("[Motion] constructor"),n&&(this.vidSrc=n)}return e.prototype.createPicture=function(){console.log("[Motion] creatPicture");var e=$("#motion-template").text(),t=Handlebars.compile(e),i={};i.vidSrc=this.vidSrc?this.vidSrc:"Nieuwe Video";var n=t(i);return $(n)},e}()},{}],9:[function(e,t){t.exports=function(){function e(e,t,i,n){console.log("[Picture] constructor"),this.$el=e,console.log(e),n&&(this.imgSrc=n),window.File&&window.FileReader&&window.FileList&&window.Blob&&console.log("Full file support")}function t(e){e.classList.add("image-input-js");var t=e.querySelector("input[type=file]");t.addEventListener("change",i);var n=document.createElement("div");n.classList.add("image-input-preview"),e.insertBefore(n,t)}function i(){if(console.log("Input changed"),this.files&&this.files[0]&&this.files[0].type.match("image.*")){var e=new FileReader,t=this.parentNode.querySelector(".image-input-preview");e.onload=function(e){var i=document.createElement("img");i.onload=function(){i.width>300?(newWidth=i.width/i.width*300,newHeight=i.height/i.width*300):(newWidth=i.width,newHeight=i.height),0===n.length?(t.style.backgroundImage="url('"+e.target.result+"')",t.style.height=newHeight+"px",t.style.width=newWidth+"px"):(alert(n.join("\n")),n=[])},i.setAttribute("src",e.target.result),i.setAttribute("width",newHeight),i.setAttribute("height",newHeight)},e.readAsDataURL(this.files[0])}else n.push("File is not a valid image")}var n=[];return e.prototype.createPicture=function(){console.log("[Picture] creatPicture");var e=$("#picture-template").text(),t=Handlebars.compile(e),i={};i.imgSrc=this.txt?this.imgSrc:"";var n=t(i);return $(n)},e.prototype.initImageInputs=function(){console.log("[Picture] initImageinputs");var e=this.$el.find(".image-input")[0];t(e)},e}()},{}],10:[function(e,t){t.exports=function(){function e(e){console.log("[Postit] constructor"),e&&(this.txt=e)}return e.prototype.createPostit=function(){console.log("[Postit] createPostit");var e=$("#postit-template").text(),t=Handlebars.compile(e),i={};i.txt=this.txt?this.txt:"Nieuwe Postit";var n=t(i);return $(n)},e}()},{}]},{},[1]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9zcmMvc2NyaXB0LmpzIiwianMvc3JjL2NsYXNzZXMvQWRkQ29udHJpYnV0b3IuanMiLCJqcy9zcmMvY2xhc3Nlcy9BcHAuanMiLCJqcy9zcmMvY2xhc3Nlcy9FbGVtZW50LmpzIiwianMvc3JjL2NsYXNzZXMvRWxlbWVudFBpY2tlci5qcyIsImpzL3NyYy9jbGFzc2VzL1doaXRlYm9hcmQuanMiLCJqcy9zcmMvY2xhc3Nlcy9XaGl0ZWJvYXJkU2V0dGluZ3MuanMiLCJqcy9zcmMvY2xhc3Nlcy9lbGVtZW50cy9Nb3Rpb24uanMiLCJqcy9zcmMvY2xhc3Nlcy9lbGVtZW50cy9QaWN0dXJlLmpzIiwianMvc3JjL2NsYXNzZXMvZWxlbWVudHMvUG9zdGl0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJDQUFBLFFBQUEsR0FBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsRUFBQSxHQUFBLENBQUEsSUFBQSxFQUFBLEdBQUEsQ0FBQSxHQUFBLEdBQUEsa0JBQUEsVUFBQSxPQUFBLEtBQUEsR0FBQSxFQUFBLE1BQUEsR0FBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsR0FBQSxHQUFBLEVBQUEsSUFBQSxHQUFBLEdBQUEsT0FBQSx1QkFBQSxFQUFBLElBQUEsTUFBQSxHQUFBLEtBQUEsbUJBQUEsRUFBQSxHQUFBLEdBQUEsRUFBQSxJQUFBLFdBQUEsR0FBQSxHQUFBLEdBQUEsS0FBQSxFQUFBLFFBQUEsU0FBQSxHQUFBLEdBQUEsR0FBQSxFQUFBLEdBQUEsR0FBQSxFQUFBLE9BQUEsR0FBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLEVBQUEsUUFBQSxFQUFBLEVBQUEsRUFBQSxHQUFBLE1BQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxHQUFBLEdBQUEsa0JBQUEsVUFBQSxRQUFBLEVBQUEsRUFBQSxFQUFBLEVBQUEsT0FBQSxJQUFBLEVBQUEsRUFBQSxHQUFBLE9BQUEsS0FBQSxHQUFBLFNBQUEsSUNBQSxXQUlBLFFBQUEsS0FDQSxHQUFBLEdBQUEsRUFBQSxlQUhBLEdBQUEsR0FBQSxFQUFBLGdCQU1BLCtDQ1JBLEVBQUEsUUFBQSxXQUdBLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxnQ0FDQSxLQUFBLElBQUEsRUFDQSxLQUFBLE1BQUEsS0FBQSxJQUFBLEtBQUEsc0JBQUEsR0FDQSxLQUFBLElBQUEsS0FBQSxzQkFBQSxHQUFBLGlCQUFBLFNBQUEsS0FBQSxjQUFBLEtBQUEsT0FXQSxNQVJBLEdBQUEsVUFBQSxjQUFBLFNBQUEsR0FDQSxFQUFBLGlCQUNBLFFBQUEsSUFBQSxVQUVBLEtBQUEsTUFBQSxNQUFBLElBSUEsMkJDakJBLEVBQUEsUUFBQSxXQU1BLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSxxQkFDQSxLQUFBLElBQUEsRUFDQSxLQUFBLFlBQ0EsS0FBQSxXQUFBLEdBQUEsR0FBQSxLQUFBLEtBQ0EsS0FBQSxjQUFBLEdBQUEsR0FBQSxLQUFBLEtBRUEsS0FBQSxHQUFBLEtBQUEsV0FBQSxxQkFBQSxLQUFBLHlCQUFBLEtBQUEsT0FDQSxLQUFBLEdBQUEsS0FBQSxjQUFBLHlCQUFBLEtBQUEsNEJBQUEsS0FBQSxPQVhBLEdBQUEsR0FBQSxFQUFBLGdCQUNBLEVBQUEsRUFBQSxtQkFDQSxFQUFBLEVBQUEsWUF3QkEsT0FaQSxHQUFBLFVBQUEseUJBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSxrQ0FDQSxLQUFBLGNBQUEsZ0JBQ0EsS0FBQSxjQUFBLFlBQUEsRUFBQSxLQUFBLEVBQUEsTUFDQSxLQUFBLFNBQUEsR0FHQSxFQUFBLFVBQUEsNEJBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSxxQ0FDQSxLQUFBLGNBQUEsZUFFQSxJQUFBLEdBQUEsS0FBQSxJQUFBLEVBQUEsS0FBQSxXQUdBLDZFQzVCQSxFQUFBLFFBQUEsV0FRQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLElBQUEseUJBQ0EsS0FBQSxJQUFBLEVBQ0EsS0FBQSxZQUFBLEVBQ0EsS0FBQSxVQUFBLEVBRUEsS0FBQSxVQURBLEtBQUEsVUFDQSxFQUFBLElBQUEsRUFFQSxFQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsbUJBQUEsT0FHQSxLQUFBLFNBQUEsRUFDQSxLQUFBLHNCQWpCQSxHQUFBLEdBQUEsRUFDQSxFQUFBLEVBQUEscUJBQ0EsRUFBQSxFQUFBLHNCQUNBLEVBQUEsRUFBQSxvQkE0RkEsT0EzRUEsR0FBQSxVQUFBLG9CQUFBLFdBQUEsUUFBQSxJQUFBLGlDQUNBLEtBQUEsSUFBQSxLQUFBLGVBQUEsT0FBQSxrQ0FBQSxLQUFBLFlBQUEsZ0JBQ0EsS0FBQSxJQUFBLEtBQUEsZ0NBQUEsS0FBQSxLQUFBLEtBQUEsVUFDQSxJQUFBLElBQ0EsSUFBQSxLQUFBLFNBQUEsS0FDQSxLQUFBLEtBQUEsU0FBQSxLQUNBLE9BQUEsRUFFQSxNQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsV0FBQSxJQUFBLEdBQ0EsS0FBQSxpQkFHQSxFQUFBLFVBQUEsY0FBQSxXQUNBLE9BREEsUUFBQSxJQUFBLDJCQUNBLEtBQUEsYUFDQSxJQUFBLFVBQ0EsS0FBQSxRQUFBLEdBQUEsR0FDQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsV0FBQSxPQUFBLEtBQUEsUUFBQSxjQUNBLEtBQUEsWUFBQSxLQUFBLElBQUEsS0FBQSxJQUFBLEtBQUEsV0FDQSxNQUNBLEtBQUEsU0FDQSxLQUFBLFFBQUEsR0FBQSxHQUFBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxZQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxXQUFBLE9BQUEsS0FBQSxRQUFBLGVBQ0EsS0FBQSxZQUFBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxZQUNBLEtBQUEsUUFBQSxpQkFDQSxNQUNBLEtBQUEsU0FDQSxLQUFBLFFBQUEsR0FBQSxHQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxXQUFBLE9BQUEsS0FBQSxRQUFBLGNBQ0EsS0FBQSxZQUFBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxjQU1BLEVBQUEsVUFBQSxZQUFBLFdBQUEsUUFBQSxJQUFBLHlCQUNBLEtBQUEsSUFBQSxLQUFBLElBQUEsS0FBQSxXQUFBLEdBQUEsWUFBQSxLQUFBLGlCQUFBLEtBQUEsT0FDQSxLQUFBLFdBQUEsR0FHQSxFQUFBLFVBQUEsaUJBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSw4QkFFQSxLQUFBLFdBQUEsRUFFQSxLQUFBLGtCQUFBLEtBQUEsaUJBQUEsS0FBQSxNQUNBLEtBQUEsZ0JBQUEsS0FBQSxlQUFBLEtBQUEsTUFFQSxLQUFBLFFBQUEsRUFBQSxRQUNBLEtBQUEsUUFBQSxFQUFBLFVBRUEsRUFDQSxTQUFBLEtBQUEsY0FBQSxJQUFBLEtBQUEsV0FBQSxNQUFBLE9BQUEsRUFFQSxTQUFBLEtBQUEsaUJBQUEsWUFBQSxLQUFBLG1CQUNBLFNBQUEsS0FBQSxpQkFBQSxVQUFBLEtBQUEsa0JBR0EsRUFBQSxVQUFBLGlCQUFBLFNBQUEsR0FDQSxHQURBLFFBQUEsSUFBQSw4QkFDQSxLQUFBLGFBQUEsRUFBQSxDQUVBLEdBQUEsR0FBQSxTQUFBLEVBQUEsU0FDQSxFQUFBLFNBQUEsRUFBQSxRQUVBLFVBQUEsS0FBQSxjQUFBLElBQUEsS0FBQSxXQUFBLE1BQUEsS0FBQSxFQUFBLEtBQUEsUUFBQSxLQUNBLFNBQUEsS0FBQSxjQUFBLElBQUEsS0FBQSxXQUFBLE1BQUEsSUFBQSxFQUFBLEtBQUEsUUFBQSxPQUlBLEVBQUEsVUFBQSxlQUFBLFdBQUEsUUFBQSxJQUFBLDRCQUVBLEtBQUEsV0FBQSxFQUVBLFNBQUEsS0FBQSxjQUFBLElBQUEsS0FBQSxXQUFBLG9CQUFBLFlBQUEsS0FBQSxtQkFDQSxTQUFBLEtBQUEsY0FBQSxJQUFBLEtBQUEsV0FBQSxvQkFBQSxVQUFBLEtBQUEsa0JBR0EsOEZDakdBLEVBQUEsUUFBQSxXQUdBLFFBQUEsR0FBQSxHQUFBLFFBQUEsSUFBQSwrQkFDQSxLQUFBLElBQUEsRUFDQSxRQUFBLElBQUEsRUFDQSxJQUFBLEdBQUEsRUFBQSw0QkFBQSxPQUNBLEVBQUEsV0FBQSxRQUFBLEdBQ0EsR0FDQSxXQUNBLFFBQUEsVUFBQSxLQUFBLFlBQ0EsUUFBQSxTQUFBLEtBQUEsVUFDQSxRQUFBLFNBQUEsS0FBQSxVQUdBLFlBQUEsZUFBQSxTQUFBLFdBQ0EsR0FBQSxHQUFBLFdBQUEsaUJBQUEsS0FBQSxTQUNBLEVBQUEsV0FBQSxpQkFBQSxLQUFBLEtBRUEsT0FBQSxJQUFBLFlBQUEsV0FDQSxVQUFBLEVBQUEsSUFBQSxFQUFBLFVBSUEsSUFBQSxHQUFBLEVBQUEsRUFDQSxNQUFBLElBQUEsS0FBQSxlQUFBLE9BQUEsRUFBQSxJQUNBLEtBQUEsZ0JBQ0EsS0FBQSxjQXVCQSxNQXBCQSxHQUFBLFVBQUEsY0FBQSxXQUFBLFFBQUEsSUFBQSxpQ0FDQSxLQUFBLElBQUEsS0FBQSxtQkFBQSxZQUFBLFdBR0EsRUFBQSxVQUFBLFlBQUEsU0FBQSxFQUFBLEdBQUEsUUFBQSxJQUFBLDhCQUNBLElBQUEsSUFDQSxJQUFBLEVBQ0EsS0FBQSxFQUVBLE1BQUEsSUFBQSxLQUFBLG1CQUFBLElBQUEsSUFHQSxFQUFBLFVBQUEsWUFBQSxXQUFBLFFBQUEsSUFBQSwrQkFDQSxLQUFBLElBQUEsS0FBQSw2QkFBQSxHQUFBLFFBQUEsS0FBQSxhQUFBLEtBQUEsUUFHQSxFQUFBLFVBQUEsYUFBQSxTQUFBLEdBQUEsUUFBQSxJQUFBLGdDQUNBLEtBQUEsS0FBQSxLQUFBLHlCQUFBLEVBQUEsT0FBQSxLQUdBLDJCQ2xEQSxFQUFBLFFBQUEsV0FJQSxRQUFBLEdBQUEsR0FBQSxRQUFBLElBQUEsNEJBQ0EsS0FBQSxJQUFBLEVBUUEsS0FBQSxtQkFDQSxLQUFBLHdCQVpBLEdBQUEsR0FBQSxFQUFBLHVCQTBDQSxPQTFCQSxHQUFBLFVBQUEsaUJBQUEsV0FBQSxRQUFBLElBQUEsaUNBQ0EsS0FBQSxNQUFBLEtBQUEsSUFBQSxPQUFBLHVDQUNBLEtBQUEsZUFHQSxFQUFBLFVBQUEsWUFBQSxXQUFBLFFBQUEsSUFBQSw0QkFDQSxLQUFBLE1BQUEsR0FBQSxRQUFBLEtBQUEsYUFBQSxLQUFBLFFBR0EsRUFBQSxVQUFBLGFBQUEsU0FBQSxHQUFBLFFBQUEsSUFBQSw0QkFDQSxJQUFBLEdBQUEsRUFBQSxNQUFBLEtBQUEsSUFBQSxTQUFBLEtBQ0EsRUFBQSxFQUFBLE1BQUEsS0FBQSxJQUFBLFNBQUEsSUFDQSxJQUNBLEdBQUEsS0FBQSxFQUNBLEVBQUEsS0FBQSxFQUNBLGVBQUEsRUFBQSxPQUFBLElBQ0EsS0FBQSxLQUFBLEtBQUEscUJBQUEsSUFJQSxFQUFBLFVBQUEsc0JBQUEsV0FBQSxRQUFBLElBQUEsc0NBQ0EsS0FBQSxtQkFBQSxHQUFBLEdBQUEsS0FBQSxLQUNBLEtBQUEsbUJBQUEscUJBQ0EsS0FBQSxtQkFBQSxrQkFHQSxtREM1Q0EsRUFBQSxRQUFBLFdBSUEsUUFBQSxHQUFBLEVBQUEsRUFBQSxHQUFBLFFBQUEsSUFBQSxvQ0FDQSxLQUFBLElBQUEsRUFDQSxLQUFBLGFBQUEsRUFDQSxJQUNBLEtBQUEsWUFBQSxHQU5BLEdBQUEsR0FBQSxFQUFBLG1CQWtDQSxPQXZCQSxHQUFBLFVBQUEsbUJBQUEsV0FBQSxRQUFBLElBQUEsMENBQ0EsSUFBQSxHQUFBLEVBQUEscUJBQUEsT0FDQSxFQUFBLFdBQUEsUUFBQSxHQUNBLElBR0EsR0FBQSxZQURBLEtBQUEsWUFDQSxLQUFBLFlBRUEsV0FHQSxFQUFBLFlBQUEsS0FBQSxXQUVBLElBQUEsR0FBQSxFQUFBLEVBQ0EsR0FBQSxlQUFBLE9BQUEsRUFBQSxLQUdBLEVBQUEsVUFBQSxlQUFBLFdBQUEsUUFBQSxJQUFBLHVDQUNBLEtBQUEsZUFBQSxHQUFBLEdBQUEsS0FBQSxJQUFBLEtBQUEsc0JBQ0EsUUFBQSxJQUFBLEtBQUEsTUFJQSwrQ0NwQ0EsRUFBQSxRQUFBLFdBRUEsUUFBQSxHQUFBLEVBQUEsRUFBQSxFQUFBLEdBQUEsUUFBQSxJQUFBLHdCQUNBLElBQ0EsS0FBQSxPQUFBLEdBa0JBLE1BZEEsR0FBQSxVQUFBLGNBQUEsV0FBQSxRQUFBLElBQUEsd0JBQ0EsSUFBQSxHQUFBLEVBQUEsb0JBQUEsT0FDQSxFQUFBLFdBQUEsUUFBQSxHQUNBLElBR0EsR0FBQSxPQURBLEtBQUEsT0FDQSxLQUFBLE9BRUEsY0FFQSxJQUFBLEdBQUEsRUFBQSxFQUNBLE9BQUEsR0FBQSxJQUdBLDJCQ3RCQSxFQUFBLFFBQUEsV0FHQSxRQUFBLEdBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxRQUFBLElBQUEseUJBQ0EsS0FBQSxJQUFBLEVBQ0EsUUFBQSxJQUFBLEdBQ0EsSUFDQSxLQUFBLE9BQUEsR0FJQSxPQUFBLE1BQ0EsT0FBQSxZQUNBLE9BQUEsVUFDQSxPQUFBLE1BRUEsUUFBQSxJQUFBLHFCQTBCQSxRQUFBLEdBQUEsR0FDQSxFQUFBLFVBQUEsSUFBQSxpQkFFQSxJQUFBLEdBQUEsRUFBQSxjQUFBLG1CQUNBLEdBQUEsaUJBQUEsU0FBQSxFQUVBLElBQUEsR0FBQSxTQUFBLGNBQUEsTUFDQSxHQUFBLFVBQUEsSUFBQSx1QkFHQSxFQUFBLGFBQUEsRUFBQSxHQUdBLFFBQUEsS0FHQSxHQUZBLFFBQUEsSUFBQSxpQkFHQSxLQUFBLE9BQ0EsS0FBQSxNQUFBLElBQ0EsS0FBQSxNQUFBLEdBQUEsS0FBQSxNQUFBLFdBQ0EsQ0FDQSxHQUFBLEdBQUEsR0FBQSxZQUNBLEVBQUEsS0FBQSxXQUFBLGNBQUEsdUJBRUEsR0FBQSxPQUFBLFNBQUEsR0FDQSxHQUFBLEdBQUEsU0FBQSxjQUFBLE1BRUEsR0FBQSxPQUFBLFdBOEJBLEVBQUEsTUFBQSxLQUNBLFNBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxJQUNBLFVBQUEsRUFBQSxPQUFBLEVBQUEsTUFBQSxNQUVBLFNBQUEsRUFBQSxNQUNBLFVBQUEsRUFBQSxRQUdBLElBQUEsRUFBQSxRQUNBLEVBQUEsTUFBQSxnQkFBQSxRQUFBLEVBQUEsT0FBQSxPQUFBLEtBQ0EsRUFBQSxNQUFBLE9BQUEsVUFBQSxLQUNBLEVBQUEsTUFBQSxNQUFBLFNBQUEsT0FLQSxNQUFBLEVBQUEsS0FBQSxPQUNBLE9BSUEsRUFBQSxhQUFBLE1BQUEsRUFBQSxPQUFBLFFBQ0EsRUFBQSxhQUFBLFFBQUEsV0FDQSxFQUFBLGFBQUEsU0FBQSxZQUlBLEVBQUEsY0FBQSxLQUFBLE1BQUEsUUFFQSxHQUFBLEtBQUEsNkJBL0hBLEdBQUEsS0E0SUEsT0F4SEEsR0FBQSxVQUFBLGNBQUEsV0FBQSxRQUFBLElBQUEseUJBQ0EsSUFBQSxHQUFBLEVBQUEscUJBQUEsT0FDQSxFQUFBLFdBQUEsUUFBQSxHQUNBLElBR0EsR0FBQSxPQURBLEtBQUEsSUFDQSxLQUFBLE9BRUEsRUFFQSxJQUFBLEdBQUEsRUFBQSxFQUNBLE9BQUEsR0FBQSxJQUtBLEVBQUEsVUFBQSxnQkFBQSxXQUFBLFFBQUEsSUFBQSw0QkFDQSxJQUFBLEdBQUEsS0FBQSxJQUFBLEtBQUEsZ0JBQUEsRUFDQSxHQUFBLElBc0dBLDRCQzdJQSxFQUFBLFFBQUEsV0FFQSxRQUFBLEdBQUEsR0FBQSxRQUFBLElBQUEsd0JBQ0EsSUFDQSxLQUFBLElBQUEsR0FrQkEsTUFkQSxHQUFBLFVBQUEsYUFBQSxXQUFBLFFBQUEsSUFBQSx3QkFDQSxJQUFBLEdBQUEsRUFBQSxvQkFBQSxPQUNBLEVBQUEsV0FBQSxRQUFBLEdBQ0EsSUFHQSxHQUFBLElBREEsS0FBQSxJQUNBLEtBQUEsSUFFQSxlQUVBLElBQUEsR0FBQSxFQUFBLEVBQ0EsT0FBQSxHQUFBLElBR0EiLCJmaWxlIjoic2NyaXB0LmRpc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIihmdW5jdGlvbigpe1xuXG5cdHZhciBBcHAgPSByZXF1aXJlKCcuL2NsYXNzZXMvQXBwJyk7XG5cblx0ZnVuY3Rpb24gaW5pdCgpwqB7XG5cdFx0bmV3IEFwcCgkKCcjY29udGFpbmVyJykpO1xuXHR9XG5cblx0aW5pdCgpO1xuXG59KSgpOyIsIm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCl7XG5cblxuXHRmdW5jdGlvbiBBZGRDb250cmlidXRvcigkZWwpIHsgY29uc29sZS5sb2coJ1tBZGRDb250cmlidXRvcl0gY29uc3RydWN0b3InKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHR0aGlzLmlucHV0ID0gdGhpcy4kZWwuZmluZCgnLmlucHV0LWNvbnRyaWJ1dG9yJylbMF07XG5cdFx0dGhpcy4kZWwuZmluZCgnLmlucHV0LWNvbnRyaWJ1dG9yJylbMF0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyLmJpbmQodGhpcykpO1xuXHR9XG5cblx0QWRkQ29udHJpYnV0b3IucHJvdG90eXBlLnN1Ym1pdEhhbmRsZXIgPSBmdW5jdGlvbihldmVudCkge1xuXHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Y29uc29sZS5sb2coXCJTVUJNVVRcIik7XG5cdFx0Ly9iZWFuLmZpcmUodGhpcywgXCJhZGRDb250cmlidXRvclwiLCB0aGlzLmlucHV0LnZhbHVlKTtcblx0XHR0aGlzLmlucHV0LnZhbHVlID0gJyc7XG5cdH07XG5cblxuXHRyZXR1cm4gQWRkQ29udHJpYnV0b3I7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgV2hpdGVib2FyZCA9IHJlcXVpcmUoJy4vV2hpdGVib2FyZCcpO1xuXHR2YXIgRWxlbWVudFBpY2tlciA9IHJlcXVpcmUoJy4vRWxlbWVudFBpY2tlcicpO1xuXHR2YXIgRWxlbWVudCA9IHJlcXVpcmUoJy4vRWxlbWVudCcpO1xuXG5cdGZ1bmN0aW9uIEFwcCgkZWwpIHsgY29uc29sZS5sb2coJ1tBcHBdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0dGhpcy5wb3NpdGlvbiA9IHt9O1xuXHRcdHRoaXMud2hpdGVib2FyZCA9IG5ldyBXaGl0ZWJvYXJkKHRoaXMuJGVsKTtcblx0XHR0aGlzLmVsZW1lbnRQaWNrZXIgPSBuZXcgRWxlbWVudFBpY2tlcih0aGlzLiRlbCk7XG5cdFx0Ly9MVUlTVEVSRU5cblx0XHRiZWFuLm9uKHRoaXMud2hpdGVib2FyZCwgXCJ3aGl0ZWJvYXJkLWNsaWNrZWRcIiwgdGhpcy53aGl0ZWJvYXJkQ2xpY2tlZEhhbmRsZXIuYmluZCh0aGlzKSk7XG5cdFx0YmVhbi5vbih0aGlzLmVsZW1lbnRQaWNrZXIsIFwiZWxlbWVudC1waWNrZXItY2xpY2tlZFwiLCB0aGlzLmVsZW1lbnRQaWNrZXJDbGlja2VkSGFuZGxlci5iaW5kKHRoaXMpKTtcblx0fVxuXG5cdEFwcC5wcm90b3R5cGUud2hpdGVib2FyZENsaWNrZWRIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQpeyBjb25zb2xlLmxvZygnW0FwcF0gd2hpdGVib2FyZENsaWNrZWRIYW5kbGVyJyk7XG5cdFx0dGhpcy5lbGVtZW50UGlja2VyLnRvZ2dsZVZpc2libGUoKTtcblx0XHR0aGlzLmVsZW1lbnRQaWNrZXIuc2V0TG9jYXRpb24oZXZlbnQueFBvcywgZXZlbnQueVBvcyk7XG5cdFx0dGhpcy5wb3NpdGlvbiA9IGV2ZW50O1xuXHR9O1xuXG5cdEFwcC5wcm90b3R5cGUuZWxlbWVudFBpY2tlckNsaWNrZWRIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQpeyBjb25zb2xlLmxvZygnW0FwcF0gZWxlbWVudFBpY2tlckNsaWNrZWRIYW5kbGVyJyk7IFxuXHRcdHRoaXMuZWxlbWVudFBpY2tlci50b2dnbGVWaXNpYmxlKCk7XG5cdFx0Ly9DUkVBVEUgQkxBTkNcblx0XHR2YXIgZWxlbWVudCA9IG5ldyBFbGVtZW50KHRoaXMuJGVsLGV2ZW50LHRoaXMucG9zaXRpb24pO1xuXHR9O1xuXG5cdHJldHVybiBBcHA7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuICAgIHZhciB6SW5kZXhDb3VudGVyID0gMTtcblx0dmFyIFBvc3RpdCA9IHJlcXVpcmUoJy4vZWxlbWVudHMvUG9zdGl0Jyk7XG5cdHZhciBQaWN0dXJlID0gcmVxdWlyZSgnLi9lbGVtZW50cy9QaWN0dXJlJyk7XG5cdHZhciBNb3Rpb24gPSByZXF1aXJlKCcuL2VsZW1lbnRzL01vdGlvbicpO1xuXG5cblx0ZnVuY3Rpb24gRWxlbWVudCgkZWwsZWxlbWVudFR5cGUscG9zaXRpb24saWQpIHsgY29uc29sZS5sb2coJ1tFbGVtZW50XSBjb25zdHJ1Y3RvcicpO1xuXHRcdHRoaXMuJGVsID0gJGVsO1xuXHRcdHRoaXMuZWxlbWVudFR5cGUgPSBlbGVtZW50VHlwZTtcblx0XHR0aGlzLmVsZW1lbnRJZCA9IGlkO1xuXHRcdGlmKHRoaXMuZWxlbWVudElkKXtcblx0XHRcdHRoaXMuZWxlbWVudElkID0gZWxlbWVudFR5cGUrXCJfXCIraWQ7XG5cdFx0fWVsc2Uge1xuXHRcdFx0dGhpcy5lbGVtZW50SWQgPSBlbGVtZW50VHlwZStcIl9cIit0aGlzLiRlbC5maW5kKFwiLmVsZW1lbnQtaG9sZGVyXCIpLmxlbmd0aDtcblx0XHR9XG5cblx0XHR0aGlzLnBvc2l0aW9uID0gcG9zaXRpb247XG5cdFx0dGhpcy5jcmVhdGVFbGVtZW50SG9sZGVyKCk7XG5cdH1cblxuXHRFbGVtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50SG9sZGVyID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tFbGVtZW50XSBjcmVhdGVFbGVtZW50SG9sZGVyJyk7XG5cdFx0dGhpcy4kZWwuZmluZChcIiN3aGl0ZWJvYXJkXCIpLmFwcGVuZChcIjxzZWN0aW9uIGNsYXNzPSdlbGVtZW50LWhvbGRlciBcIit0aGlzLmVsZW1lbnRUeXBlK1wiJz48L3NlY3Rpb24+XCIpO1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIuZWxlbWVudC1ob2xkZXI6bGFzdC1vZi10eXBlXCIpLmF0dHIoJ2lkJywgdGhpcy5lbGVtZW50SWQpO1xuXHRcdHZhciBwb3NpdGlvbiA9IHtcblx0XHRcdHRvcCA6IHRoaXMucG9zaXRpb24ueVBvcyxcblx0XHRcdGxlZnQgOiB0aGlzLnBvc2l0aW9uLnhQb3MsXG5cdFx0XHR6SW5kZXg6IDBcblx0XHR9O1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpLmNzcyhwb3NpdGlvbik7XG5cdFx0dGhpcy5jcmVhdGVFbGVtZW50KCk7XG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUuY3JlYXRlRWxlbWVudCA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbRWxlbWVudF0gY3JlYXRlRWxlbWVudCcpO1xuXHRcdHN3aXRjaCh0aGlzLmVsZW1lbnRUeXBlKSB7XG5cdFx0ICAgIGNhc2UgXCJwb3N0LWl0XCI6XG5cdFx0ICAgIFx0dGhpcy5lbGVtZW50ID0gbmV3IFBvc3RpdCgpO1xuXHRcdCAgICBcdHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpLmFwcGVuZCh0aGlzLmVsZW1lbnQuY3JlYXRlUG9zdGl0KTtcblx0XHQgICAgXHR0aGlzLmJpbmRIYW5kbGVyKHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpKTtcblx0XHQgICAgICAgIGJyZWFrO1xuXHRcdCAgICBjYXNlIFwic3RhdGljXCI6XG5cdFx0ICAgIFx0dGhpcy5lbGVtZW50ID0gbmV3IFBpY3R1cmUodGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkpO1xuXHRcdCAgICBcdHRoaXMuJGVsLmZpbmQoXCIjXCIrdGhpcy5lbGVtZW50SWQpLmFwcGVuZCh0aGlzLmVsZW1lbnQuY3JlYXRlUGljdHVyZSk7XG5cdFx0ICAgIFx0dGhpcy5iaW5kSGFuZGxlcih0aGlzLiRlbC5maW5kKFwiI1wiK3RoaXMuZWxlbWVudElkKSk7XG5cdFx0ICAgIFx0dGhpcy5lbGVtZW50LmluaXRJbWFnZUlucHV0cygpO1xuXHRcdCAgICAgICAgYnJlYWs7XG5cdFx0ICAgIGNhc2UgXCJtb3Rpb25cIjpcblx0XHQgICAgXHR0aGlzLmVsZW1lbnQgPSBuZXcgTW90aW9uKCk7XG5cdFx0ICAgIFx0dGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkuYXBwZW5kKHRoaXMuZWxlbWVudC5jcmVhdGVNb3Rpb24pO1xuXHRcdCAgICBcdHRoaXMuYmluZEhhbmRsZXIodGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkpO1xuXHRcdCAgICAgICAgYnJlYWs7XG5cdFx0fVxuXG5cdH07XG5cblx0RWxlbWVudC5wcm90b3R5cGUuYmluZEhhbmRsZXIgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIGJpbmRIYW5kbGVyJyk7XG5cdFx0dGhpcy4kZWwuZmluZChcIiNcIit0aGlzLmVsZW1lbnRJZCkub24oJ21vdXNlZG93bicsIHRoaXMubW91c2Vkb3duSGFuZGxlci5iaW5kKHRoaXMpKTtcblx0XHR0aGlzLm1vdXNlRG93biA9IGZhbHNlO1xuXHR9O1xuXG5cdEVsZW1lbnQucHJvdG90eXBlLm1vdXNlZG93bkhhbmRsZXIgPSBmdW5jdGlvbihlKXsgY29uc29sZS5sb2coJ1tFbGVtZW50XSBtb3VzZWRvd25IYW5kbGVyJyk7XG5cbiAgICAgICAgdGhpcy5tb3VzZURvd24gPSB0cnVlO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5fbW91c2VNb3ZlSGFuZGxlciA9IHRoaXMubW91c2VNb3ZlSGFuZGxlci5iaW5kKHRoaXMpO1xuICAgICAgICB0aGlzLl9tb3VzZVVwSGFuZGxlciA9IHRoaXMubW91c2VVcEhhbmRsZXIuYmluZCh0aGlzKTtcblxuICAgICAgICB0aGlzLm9mZnNldFggPSBlLm9mZnNldFg7XG4gICAgICAgIHRoaXMub2Zmc2V0WSA9IGUub2Zmc2V0WTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgKyt6SW5kZXhDb3VudGVyO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyMnK3RoaXMuZWxlbWVudElkKS5zdHlsZS56SW5kZXggPSB6SW5kZXhDb3VudGVyO1xuICAgICAgICBcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9tb3VzZU1vdmVIYW5kbGVyKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5fbW91c2VVcEhhbmRsZXIpO1xuXHR9O1xuXG4gICAgRWxlbWVudC5wcm90b3R5cGUubW91c2VNb3ZlSGFuZGxlciA9IGZ1bmN0aW9uKGUpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIG1vdXNlbW92ZUhhbmRsZXInKTtcbiAgICAgICAgaWYodGhpcy5tb3VzZURvd24gPT09IHRydWUpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbW91c2VYID0gcGFyc2VJbnQoZS5jbGllbnRYKTtcbiAgICAgICAgICAgIHZhciBtb3VzZVkgPSBwYXJzZUludChlLmNsaWVudFkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyMnK3RoaXMuZWxlbWVudElkKS5zdHlsZS5sZWZ0ID0gKG1vdXNlWCAtIHRoaXMub2Zmc2V0WCkgKyBcInB4XCI7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyMnK3RoaXMuZWxlbWVudElkKS5zdHlsZS50b3AgPSAobW91c2VZIC0gdGhpcy5vZmZzZXRZKSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBFbGVtZW50LnByb3RvdHlwZS5tb3VzZVVwSGFuZGxlciA9IGZ1bmN0aW9uKGUpeyBjb25zb2xlLmxvZygnW0VsZW1lbnRdIG1vdXNldXBIYW5kbGVyJyk7XG5cbiAgICAgICAgdGhpcy5tb3VzZURvd24gPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignIycrdGhpcy5lbGVtZW50SWQpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHRoaXMuX21vdXNlTW92ZUhhbmRsZXIpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyMnK3RoaXMuZWxlbWVudElkKS5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgdGhpcy5fbW91c2VVcEhhbmRsZXIpO1xuICAgIH07XG5cblx0cmV0dXJuIEVsZW1lbnQ7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXG5cdGZ1bmN0aW9uIEVsZW1lbnRQaWNrZXIoJGVsKSB7IGNvbnNvbGUubG9nKCdbRWxlbWVudFBpY2tlcl0gY29uc3RydWN0b3InKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHRjb25zb2xlLmxvZygkZWwpO1xuXHRcdHZhciBlbnRyeVRleHQgPSAkKCcjZWxlbWVudC1waWNrZXItdGVtcGxhdGUnKS50ZXh0KCk7XG5cdFx0dmFyIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKGVudHJ5VGV4dCk7XG5cdFx0dmFyIGNvbnRleHQgPSB7XG5cdFx0ICBlbGVtZW50czogW1x0XG5cdFx0ICBcdFx0XHR7ZWxlbWVudDogXCJwb3N0LWl0XCIsIG5hbWU6IFwicG9zdC1pdFwifSxcblx0XHQgIFx0XHRcdHtlbGVtZW50OiBcInN0YXRpY1wiLCBuYW1lOiBcImltYWdlXCJ9LFxuXHRcdCAgXHRcdFx0e2VsZW1lbnQ6IFwibW90aW9uXCIsIG5hbWU6IFwidmlkZW9cIn1cbiAgXHRcdFx0XHRdXG4gIFx0XHRcdH07XG5cdFx0XHRIYW5kbGViYXJzLnJlZ2lzdGVySGVscGVyKCdwaWNrZXInLCBmdW5jdGlvbigpIHtcblx0XHRcdCAgdmFyIGVsZW1lbnQgPSBIYW5kbGViYXJzLmVzY2FwZUV4cHJlc3Npb24odGhpcy5lbGVtZW50KSxcblx0XHRcdCAgICAgIG5hbWUgPSBIYW5kbGViYXJzLmVzY2FwZUV4cHJlc3Npb24odGhpcy5uYW1lKTtcblxuXHRcdFx0ICByZXR1cm4gbmV3IEhhbmRsZWJhcnMuU2FmZVN0cmluZyhcblx0XHRcdCAgICBcIjxsaSBpZD1cIitlbGVtZW50K1wiPlwiK25hbWUrXCI8L2xpPlwiXG5cdFx0XHQgICk7XG5cdFx0XHR9KTtcblx0XHRcblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXHRcdHRoaXMuJGVsLmZpbmQoXCIjd2hpdGVib2FyZFwiKS5hcHBlbmQoICQoaHRtbCkgKTtcblx0XHR0aGlzLnRvZ2dsZVZpc2libGUoKTtcblx0XHR0aGlzLmJpbmRIYW5kbGVyKCk7XG5cdH1cblxuXHRFbGVtZW50UGlja2VyLnByb3RvdHlwZS50b2dnbGVWaXNpYmxlID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tFbGVtZW50UGlja2VyXSB0b2dnbGVWaXNpYmxlJyk7XG5cdFx0dGhpcy4kZWwuZmluZCgnI2VsZW1lbnQtcGlja2VyJykudG9nZ2xlQ2xhc3MoXCJoaWRkZW5cIik7XG5cdH07XG5cblx0RWxlbWVudFBpY2tlci5wcm90b3R5cGUuc2V0TG9jYXRpb24gPSBmdW5jdGlvbih4UG9zLCB5UG9zKXsgY29uc29sZS5sb2coJ1tFbGVtZW50UGlja2VyXSBzZXRMb2NhdGlvbicpO1xuXHRcdHZhciBwb3NpdGlvbiA9IHtcblx0XHRcdHRvcCA6IHlQb3MsXG5cdFx0XHRsZWZ0IDogeFBvc1xuXHRcdH07XG5cdFx0dGhpcy4kZWwuZmluZChcIiNlbGVtZW50LXBpY2tlclwiKS5jc3MocG9zaXRpb24pO1xuXHR9O1xuXG5cdEVsZW1lbnRQaWNrZXIucHJvdG90eXBlLmJpbmRIYW5kbGVyID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tFbGVtZW50UGlja2VyXSBiaW5kSGFuZGxlcicpO1xuXHRcdHRoaXMuJGVsLmZpbmQoJyNlbGVtZW50LXBpY2tlciA+IHVsID4gbGknKS5vbignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlci5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHRFbGVtZW50UGlja2VyLnByb3RvdHlwZS5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbRWxlbWVudFBpY2tlcl0gY2xpY2tIYW5kbGVyJyk7XG5cdFx0YmVhbi5maXJlKHRoaXMsIFwiZWxlbWVudC1waWNrZXItY2xpY2tlZFwiLCBldmVudC50YXJnZXQuaWQpO1xuXHR9O1xuXG5cdHJldHVybiBFbGVtZW50UGlja2VyO1xuXG59KSgpOyIsIm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCl7XG5cblx0dmFyIFdoaXRlYm9hcmRTZXR0aW5ncyA9IHJlcXVpcmUgKCcuL1doaXRlYm9hcmRTZXR0aW5ncycpO1xuXG5cdGZ1bmN0aW9uIFdoaXRlYm9hcmQoJGVsLCBib2FyZE5hbWUpIHsgY29uc29sZS5sb2coJ1tXaGl0ZWJvYXJkXSBjb25zdHJ1Y3RvcicpO1xuXHRcdHRoaXMuJGVsID0gJGVsO1xuXHRcdC8qXG5cdFx0aWYoYm9hcmROYW1lKXtcblx0XHRcdHRoaXMuYm9hcmROYW1lID0gYm9hcmROYW1lO1xuXHRcdH1lbHNle1xuXHRcdFx0dGhpcy5ib2FyZE5hbWUgPSBcIk5pZXV3IGJvYXJkXCI7XG5cdFx0fVxuXHRcdCovXG5cdFx0dGhpcy5jcmVhdGVXaGl0ZWJvYXJkKCk7XG5cdFx0dGhpcy5hZGRXaGl0ZWJvYXJkU2V0dGluZ3MoKTtcblxuXHR9XG5cblx0V2hpdGVib2FyZC5wcm90b3R5cGUuY3JlYXRlV2hpdGVib2FyZCA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbV2hpdGVib2FyZF0gY3JlYXRlV2hpdGVib2FyZCcpO1xuXHRcdHRoaXMuYm9hcmQgPSB0aGlzLiRlbC5hcHBlbmQoXCI8YXJ0aWNsZSBpZD0nd2hpdGVib2FyZCc+PC9hcnRpY2xlPlwiKTtcblx0XHR0aGlzLmJpbmRIYW5kbGVyKCk7XG5cdH07XG5cblx0V2hpdGVib2FyZC5wcm90b3R5cGUuYmluZEhhbmRsZXIgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW1doaXRlYm9hcmRdIGJpbmRIYW5kbGVyJyk7XG5cdFx0dGhpcy5ib2FyZC5vbignY2xpY2snLCB0aGlzLmNsaWNrSGFuZGxlci5iaW5kKHRoaXMpKTtcblx0fTtcblxuXHRXaGl0ZWJvYXJkLnByb3RvdHlwZS5jbGlja0hhbmRsZXIgPSBmdW5jdGlvbihldmVudCl7IGNvbnNvbGUubG9nKCdbV2hpdGVib2FyZF0gY2xpY2tIYW5kbGVyJyk7XG5cdFx0dmFyIHhQb3MgPSBldmVudC5wYWdlWCAtIHRoaXMuJGVsLm9mZnNldCgpLmxlZnQ7XG4gICBcdFx0dmFyIHlQb3MgPSBldmVudC5wYWdlWSAtIHRoaXMuJGVsLm9mZnNldCgpLnRvcDtcbiAgIFx0XHR2YXIgcG9zaXRpb24gPSB7fTtcbiAgIFx0XHRwb3NpdGlvbi54UG9zID0geFBvcztcbiAgIFx0XHRwb3NpdGlvbi55UG9zID0geVBvcztcblx0XHRpZihldmVudC50YXJnZXQuaWQgPT09IFwid2hpdGVib2FyZFwiKXsgLy9hbmRlcnMga2xpa3QgaGlqIFwiZG9vclwiIGVsZW1lbnRlblxuXHRcdFx0YmVhbi5maXJlKHRoaXMsIFwid2hpdGVib2FyZC1jbGlja2VkXCIsIHBvc2l0aW9uKTtcblx0XHR9XG5cdH07XG5cblx0V2hpdGVib2FyZC5wcm90b3R5cGUuYWRkV2hpdGVib2FyZFNldHRpbmdzID0gZnVuY3Rpb24oKXsgY29uc29sZS5sb2coJ1tXaGl0ZWJvYXJkXSBhZGRXaGl0ZWJvYXJkU2V0dGluZ3MnKTtcblx0XHR0aGlzLndoaXRlYm9hcmRTZXR0aW5ncyA9IG5ldyBXaGl0ZWJvYXJkU2V0dGluZ3ModGhpcy4kZWwpO1xuXHRcdHRoaXMud2hpdGVib2FyZFNldHRpbmdzLmNyZWF0ZVNldHRpbmdQYW5lbCgpO1xuXHRcdHRoaXMud2hpdGVib2FyZFNldHRpbmdzLmFkZENvbnRyaWJ1dG9yKCk7XG5cdH07XG5cblx0cmV0dXJuIFdoaXRlYm9hcmQ7XG5cbn0pKCk7IiwibW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKXtcblxuXHR2YXIgQWRkQ29udHJpYnV0b3IgPSByZXF1aXJlKCcuL0FkZENvbnRyaWJ1dG9yJyk7XG5cblx0ZnVuY3Rpb24gV2hpdGVib2FyZFNldHRpbmdzKCRlbCwgY29udHJpYnV0b3JzLCBwcmpjdF90aXRsZSkgeyBjb25zb2xlLmxvZygnW1doaXRlYm9hcmRTZXR0aW5nc10gY29uc3RydWN0b3InKTtcblx0XHR0aGlzLiRlbCA9ICRlbDtcblx0XHR0aGlzLmNvbnRyaWJ1dG9ycyA9IGNvbnRyaWJ1dG9ycztcblx0XHRpZihwcmpjdF90aXRsZSl7XG5cdFx0XHR0aGlzLnByamN0X3RpdGxlID0gcHJqY3RfdGl0bGU7XG5cdFx0fVxuXG5cdH1cblxuXHRXaGl0ZWJvYXJkU2V0dGluZ3MucHJvdG90eXBlLmNyZWF0ZVNldHRpbmdQYW5lbCA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbV2hpdGVib2FyZFNldHRpbmdzXSBjcmVhdGVTZXR0aW5nUGFuZWwnKTtcblx0XHR2YXIgZW50cnlUZXh0ID0gJCgnI3NldHRpbmctdGVtcGxhdGUnKS50ZXh0KCk7XG5cdFx0dmFyIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKGVudHJ5VGV4dCk7XG5cdFx0dmFyIGNvbnRleHQgPSB7fTtcblxuXHRcdGlmKHRoaXMucHJqY3RfdGl0bGUpe1xuXHRcdFx0Y29udGV4dC5wcmpjdF90aXRsZSA9IHRoaXMucHJqY3RfdGl0bGU7XG5cdFx0fWVsc2V7XG5cdFx0XHRjb250ZXh0LnByamN0X3RpdGxlID0gXCJVbnRpdGxlZFwiO1xuXHRcdH1cblxuXHRcdGNvbnRleHQuY29udHJpYnV0b3IgPSB0aGlzLmNvbnRyaWJ1dG9yO1xuXG5cdFx0dmFyIGh0bWwgPSB0ZW1wbGF0ZShjb250ZXh0KTtcblx0XHQkKCcjd2hpdGVib2FyZCcpLmFwcGVuZCggJChodG1sKSApO1xuXHR9O1xuXG5cdFdoaXRlYm9hcmRTZXR0aW5ncy5wcm90b3R5cGUuYWRkQ29udHJpYnV0b3IgPSBmdW5jdGlvbigpe2NvbnNvbGUubG9nKCdbV2hpdGVib2FyZFNldHRpbmdzXSBhZGRDb250cmlidXRvcicpO1xuXHRcdHRoaXMuYWRkQ29udHJpYnV0b3IgPSBuZXcgQWRkQ29udHJpYnV0b3IodGhpcy4kZWwuZmluZCgnLmNvbnRyaWJ1dG9yLWZvcm0nKSk7XG5cdFx0Y29uc29sZS5sb2codGhpcy4kZWwpO1xuXHRcdC8vdGhpcy5BZGRDb250cmlidXRvci5jcmVhdGVTZXR0aW5nUGFuZWwoKTtcblx0fTtcblxuXHRyZXR1cm4gV2hpdGVib2FyZFNldHRpbmdzO1xuXG59KSgpOyIsIm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCl7XG5cblx0ZnVuY3Rpb24gTW90aW9uKCRlbCx4UG9zLHlQb3MsdmlkU3JjKSB7IGNvbnNvbGUubG9nKCdbTW90aW9uXSBjb25zdHJ1Y3RvcicpO1xuXHRcdGlmKHZpZFNyYyl7XG5cdFx0dGhpcy52aWRTcmMgPSB2aWRTcmM7XG5cdFx0fTtcblx0fTtcblxuXHRNb3Rpb24ucHJvdG90eXBlLmNyZWF0ZVBpY3R1cmUgPSBmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnW01vdGlvbl0gY3JlYXRQaWN0dXJlJyk7XG5cdFx0dmFyIGVudHJ5VGV4dCA9ICQoJyNtb3Rpb24tdGVtcGxhdGUnKS50ZXh0KCk7XG5cdFx0dmFyIHRlbXBsYXRlID0gSGFuZGxlYmFycy5jb21waWxlKGVudHJ5VGV4dCk7XG5cdFx0dmFyIGNvbnRleHQgPSB7fTtcblxuXHRcdGlmKHRoaXMudmlkU3JjKXtcblx0XHRcdGNvbnRleHQudmlkU3JjID0gdGhpcy52aWRTcmM7XG5cdFx0fWVsc2V7XG5cdFx0XHRjb250ZXh0LnZpZFNyYyA9IFwiTmlldXdlIFZpZGVvXCI7XG5cdFx0fVxuXHRcdHZhciBodG1sID0gdGVtcGxhdGUoY29udGV4dCk7XG5cdFx0cmV0dXJuICgkKGh0bWwpKTtcblx0fTtcblxuXHRyZXR1cm4gTW90aW9uO1xuXG59KSgpOyIsIm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCl7XG5cdHZhciBlcnJvcnMgPSBbXTtcblxuXHRmdW5jdGlvbiBQaWN0dXJlKCRlbCx4UG9zLHlQb3MsIGltZ1NyYykgeyBjb25zb2xlLmxvZygnW1BpY3R1cmVdIGNvbnN0cnVjdG9yJyk7XG5cdFx0dGhpcy4kZWwgPSAkZWw7XG5cdFx0Y29uc29sZS5sb2coJGVsKTtcblx0XHRpZihpbWdTcmMpe1xuXHRcdHRoaXMuaW1nU3JjID0gaW1nU3JjO1xuXHRcdH07XG5cblx0XHRpZiAoXG5cdFx0XHR3aW5kb3cuRmlsZSAmJiBcblx0XHRcdHdpbmRvdy5GaWxlUmVhZGVyICYmIFxuXHRcdFx0d2luZG93LkZpbGVMaXN0ICYmIFxuXHRcdFx0d2luZG93LkJsb2Jcblx0XHQpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiRnVsbCBmaWxlIHN1cHBvcnRcIik7XG5cblx0XHR9O1xuXHR9XG5cblx0UGljdHVyZS5wcm90b3R5cGUuY3JlYXRlUGljdHVyZSA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbUGljdHVyZV0gY3JlYXRQaWN0dXJlJyk7XG5cdFx0dmFyIGVudHJ5VGV4dCA9ICQoJyNwaWN0dXJlLXRlbXBsYXRlJykudGV4dCgpO1xuXHRcdHZhciB0ZW1wbGF0ZSA9IEhhbmRsZWJhcnMuY29tcGlsZShlbnRyeVRleHQpO1xuXHRcdHZhciBjb250ZXh0ID0ge307XG5cblx0XHRpZih0aGlzLnR4dCl7XG5cdFx0XHRjb250ZXh0LmltZ1NyYyA9IHRoaXMuaW1nU3JjO1xuXHRcdH1lbHNle1xuXHRcdFx0Y29udGV4dC5pbWdTcmMgPSBcIlwiO1xuXHRcdH1cblx0XHR2YXIgaHRtbCA9IHRlbXBsYXRlKGNvbnRleHQpO1xuXHRcdHJldHVybigkKGh0bWwpKTtcblxuXHR9O1xuXG5cdFxuXHRQaWN0dXJlLnByb3RvdHlwZS5pbml0SW1hZ2VJbnB1dHM9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbUGljdHVyZV0gaW5pdEltYWdlaW5wdXRzJyk7XG5cdFx0XHR2YXIgaW1nSW5wdXRzID0gdGhpcy4kZWwuZmluZCgnLmltYWdlLWlucHV0JylbMF07XG5cdFx0XHRpbml0SW1hZ2VJbXB1dChpbWdJbnB1dHMpO1xuXHR9O1xuXHRcblx0ZnVuY3Rpb24gaW5pdEltYWdlSW1wdXQoZWwpe1xuXHRcdGVsLmNsYXNzTGlzdC5hZGQoJ2ltYWdlLWlucHV0LWpzJyk7XG5cblx0XHR2YXIgZmlsZUlucHV0ID0gZWwucXVlcnlTZWxlY3RvcignaW5wdXRbdHlwZT1maWxlXScpO1xuXHRcdGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBjcmVhdGVUaHVtYik7XG5cdFx0XG5cdFx0dmFyIHByZXZpZXdDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcblx0XHRwcmV2aWV3Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2ltYWdlLWlucHV0LXByZXZpZXcnKTtcblxuXHRcdFxuXHRcdGVsLmluc2VydEJlZm9yZShwcmV2aWV3Q29udGFpbmVyLCBmaWxlSW5wdXQpO1xuXHR9XG5cdFxuXHRmdW5jdGlvbiBjcmVhdGVUaHVtYihlKXtcblx0XHRjb25zb2xlLmxvZyhcIklucHV0IGNoYW5nZWRcIik7XG5cblx0XHRpZiAoXG5cdFx0XHR0aGlzLmZpbGVzICYmIFxuXHRcdFx0dGhpcy5maWxlc1swXSAmJiBcblx0XHRcdHRoaXMuZmlsZXNbMF0udHlwZS5tYXRjaCgnaW1hZ2UuKicpXG5cdFx0KSB7XG5cdFx0XHR2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblx0XHRcdHZhciBwcmV2aWV3Q29udGFpbmVyID0gdGhpcy5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5pbWFnZS1pbnB1dC1wcmV2aWV3Jyk7XG5cblx0XHRcdHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKXtcblx0XHRcdFx0dmFyIGltZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuXG5cdFx0XHRcdGltZy5vbmxvYWQgPSBmdW5jdGlvbigpe1xuXG5cdFx0XHRcdFx0LyppZiAoXG5cdFx0XHRcdFx0XHRwcmV2aWV3Q29udGFpbmVyLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXdpZHRoJykgJiYgXG5cdFx0XHRcdFx0XHRpbWcud2lkdGggIT0gcGFyc2VJbnQocHJldmlld0NvbnRhaW5lci5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS13aWR0aCcpKVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0ZXJyb3JzLnB1c2goXCJJbWFnZSBzaG91bGQgYmUgXCIrIHByZXZpZXdDb250YWluZXIucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtd2lkdGgnKSArXCIgcGl4ZWxzIHdpZGVcIik7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0cHJldmlld0NvbnRhaW5lci5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1oZWlnaHQnKSAmJiBcblx0XHRcdFx0XHRcdGltZy5oZWlnaHQgIT0gcGFyc2VJbnQocHJldmlld0NvbnRhaW5lci5wYXJlbnROb2RlLmdldEF0dHJpYnV0ZSgnZGF0YS1oZWlnaHQnKSlcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdGVycm9ycy5wdXNoKFwiSW1hZ2Ugc2hvdWxkIGJlIFwiKyBwcmV2aWV3Q29udGFpbmVyLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXdpZHRoJykgK1wiIHBpeGVscyBoaWdoXCIpO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdHByZXZpZXdDb250YWluZXIucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcmF0aW8nKVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0dmFyIHNwbGl0UmF0aW8gPSBwcmV2aWV3Q29udGFpbmVyLnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCdkYXRhLXJhdGlvJykuc3BsaXQoJzonKTtcblx0XHRcdFx0XHRcdGlmKHNwbGl0UmF0aW8ubGVuZ3RoID4gMSl7XG5cdFx0XHRcdFx0XHRcdHZhciB3ID0gcGFyc2VJbnQoc3BsaXRSYXRpb1swXSk7XG5cdFx0XHRcdFx0XHRcdHZhciBoID0gcGFyc2VJbnQoc3BsaXRSYXRpb1sxXSk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRpZiAoKGltZy53aWR0aCAvIGltZy5oZWlnaHQpICE9PSAodyAvIGgpKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZXJyb3JzLnB1c2goXCJJbWFnZSByYXRpbyBzaG91bGQgYmUgXCIrIHcgK1wieFwiKyBoKTtcdFxuXHRcdFx0XHRcdFx0XHR9XHRcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9Ki9cblxuXHRcdFx0XHRcdGlmKGltZy53aWR0aCA+IDMwMCApe1xuXHRcdFx0XHRcdFx0bmV3V2lkdGggPSBpbWcud2lkdGgvaW1nLndpZHRoKjMwMDtcblx0XHRcdFx0XHRcdG5ld0hlaWdodCA9IGltZy5oZWlnaHQvaW1nLndpZHRoKjMwMDtcblx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdG5ld1dpZHRoID0gaW1nLndpZHRoO1xuXHRcdFx0XHRcdFx0bmV3SGVpZ2h0ID0gaW1nLmhlaWdodDtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRpZihlcnJvcnMubGVuZ3RoID09PSAwKXtcblx0XHRcdFx0XHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gXCJ1cmwoJ1wiKyBlLnRhcmdldC5yZXN1bHQgK1wiJylcIjtcblx0XHRcdFx0XHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUuaGVpZ2h0ID0gbmV3SGVpZ2h0K1wicHhcIjtcblx0XHRcdFx0XHRcdHByZXZpZXdDb250YWluZXIuc3R5bGUud2lkdGggPSBuZXdXaWR0aCtcInB4XCI7XG5cblxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0fWVsc2V7XG5cdFx0XHRcdFx0XHRhbGVydChlcnJvcnMuam9pbihcIlxcblwiKSk7XG5cdFx0XHRcdFx0XHRlcnJvcnMgPSBbXTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdGltZy5zZXRBdHRyaWJ1dGUoJ3NyYycsIGUudGFyZ2V0LnJlc3VsdCk7XG5cdFx0XHRcdGltZy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgbmV3SGVpZ2h0KTtcblx0XHRcdFx0aW1nLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgbmV3SGVpZ2h0KTtcblxuXHRcdFx0fVxuXG5cdFx0XHRyZWFkZXIucmVhZEFzRGF0YVVSTCh0aGlzLmZpbGVzWzBdKTtcblx0XHR9ZWxzZXtcblx0XHRcdGVycm9ycy5wdXNoKFwiRmlsZSBpcyBub3QgYSB2YWxpZCBpbWFnZVwiKTtcblx0XHR9XG5cdFx0XG5cdH1cblx0XG5cdGZ1bmN0aW9uIGNoZWNrRXJyb3JzKCl7XG5cdFx0aWYoZXJyb3JzLmxlbmd0aCA9PT0gMCl7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fWVsc2V7XG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHR9XG5cdH1cblxuXHRyZXR1cm4gUGljdHVyZTtcblxufSkoKTsiLCJtb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpe1xuXG5cdGZ1bmN0aW9uIFBvc3RpdCh0eHQpIHsgY29uc29sZS5sb2coJ1tQb3N0aXRdIGNvbnN0cnVjdG9yJyk7XG5cdFx0aWYodHh0KXtcblx0XHR0aGlzLnR4dCA9IHR4dDtcblx0XHR9XG5cdH1cblxuXHRQb3N0aXQucHJvdG90eXBlLmNyZWF0ZVBvc3RpdCA9IGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdbUG9zdGl0XSBjcmVhdGVQb3N0aXQnKTtcblx0XHR2YXIgZW50cnlUZXh0ID0gJCgnI3Bvc3RpdC10ZW1wbGF0ZScpLnRleHQoKTtcblx0XHR2YXIgdGVtcGxhdGUgPSBIYW5kbGViYXJzLmNvbXBpbGUoZW50cnlUZXh0KTtcblx0XHR2YXIgY29udGV4dCA9IHt9O1xuXG5cdFx0aWYodGhpcy50eHQpe1xuXHRcdFx0Y29udGV4dC50eHQgPSB0aGlzLnR4dDtcblx0XHR9ZWxzZXtcblx0XHRcdGNvbnRleHQudHh0ID0gXCJOaWV1d2UgUG9zdGl0XCI7XG5cdFx0fVxuXHRcdHZhciBodG1sID0gdGVtcGxhdGUoY29udGV4dCk7XG5cdFx0cmV0dXJuICgkKGh0bWwpKTtcblx0fTtcblxuXHRyZXR1cm4gUG9zdGl0O1xuXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==